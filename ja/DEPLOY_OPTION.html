
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aws-samples.github.io/generative-ai-use-cases/ja/DEPLOY_OPTION.html">
      
      
        <link rel="prev" href="DEPLOY_ON_CLOUDSHELL.html">
      
      
        <link rel="next" href="SAML_WITH_GOOGLE_WORKSPACE.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>デプロイオプション - Generative AI Use Cases (GenU)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/custom/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="デプロイオプション - Generative AI Use Cases (GenU)" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://aws-samples.github.io/generative-ai-use-cases/assets/images/social/ja/DEPLOY_OPTION.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://aws-samples.github.io/generative-ai-use-cases/ja/DEPLOY_OPTION.html" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="デプロイオプション - Generative AI Use Cases (GenU)" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://aws-samples.github.io/generative-ai-use-cases/assets/images/social/ja/DEPLOY_OPTION.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#デプロイオプション" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="index.html" title="Generative AI Use Cases (GenU)" class="md-header__button md-logo" aria-label="Generative AI Use Cases (GenU)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Generative AI Use Cases (GenU)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              デプロイオプション
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="言語切り替え">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../en/DEPLOY_OPTION.html" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="DEPLOY_OPTION.html" hreflang="ja" class="md-select__link">
              日本語
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="共有" aria-label="共有" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aws-samples/generative-ai-use-cases" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/generative-ai-use-cases
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
  
    
  
  概要

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="ABOUT.html" class="md-tabs__link">
          
  
  
    
  
  Getting started

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Generative AI Use Cases (GenU)" class="md-nav__button md-logo" aria-label="Generative AI Use Cases (GenU)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Generative AI Use Cases (GenU)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aws-samples/generative-ai-use-cases" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    aws-samples/generative-ai-use-cases
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    デプロイ方法
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            デプロイ方法
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ABOUT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    クイックスタート
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DEPLOY_ON_CLOUDSHELL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    (オプション) AWS CloudShell でデプロイする
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    デプロイオプション
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="DEPLOY_OPTION.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    デプロイオプション
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#設定方法" class="md-nav__link">
    <span class="md-ellipsis">
      設定方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="設定方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameterts-の値を変更する方法" class="md-nav__link">
    <span class="md-ellipsis">
      parameter.ts の値を変更する方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cdkjson-の値を変更する方法" class="md-nav__link">
    <span class="md-ellipsis">
      cdk.json の値を変更する方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ユースケースの設定" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースの設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ユースケースの設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rag-チャット-amazon-kendra-ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      RAG チャット (Amazon Kendra) ユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG チャット (Amazon Kendra) ユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#既存の-amazon-kendra-index-を利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      既存の Amazon Kendra Index を利用したい場合
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag-チャット-knowledge-base-ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      RAG チャット (Knowledge Base) ユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG チャット (Knowledge Base) ユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advanced-parsing-を有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Parsing を有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#チャンク戦略を変更" class="md-nav__link">
    <span class="md-ellipsis">
      チャンク戦略を変更
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-vector-embedding-を有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Vector Embedding を有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-base-や-opensearch-service-を再作成して変更を加える" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Base や OpenSearch Service を再作成して変更を加える
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensearch-service-の-index-をマネージメントコンソールで確認する方法" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSearch Service の Index をマネージメントコンソールで確認する方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#メタデータフィルターの設定" class="md-nav__link">
    <span class="md-ellipsis">
      メタデータフィルターの設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-チャットユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Agent チャットユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent チャットユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-interpreter-エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      Code Interpreter エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#検索エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      検索エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#手動で作成した-agent-を追加" class="md-nav__link">
    <span class="md-ellipsis">
      手動で作成した Agent を追加
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-bases-for-amazon-bedrock-エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Bases for Amazon Bedrock エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-をインライン表示にする" class="md-nav__link">
    <span class="md-ellipsis">
      Agent をインライン表示にする
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-チャットユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Flow チャットユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#画像生成ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      画像生成ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#動画生成ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      動画生成ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#映像分析ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      映像分析ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#プロンプト最適化ツールの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      プロンプト最適化ツールの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#特定のユースケースを非表示にする" class="md-nav__link">
    <span class="md-ellipsis">
      特定のユースケースを非表示にする
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ユースケースビルダーの設定" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースビルダーの設定
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-bedrock-のモデルを変更する" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon Bedrock のモデルを変更する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon Bedrock のモデルを変更する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#複数のリージョンのモデルを同時に利用する" class="md-nav__link">
    <span class="md-ellipsis">
      複数のリージョンのモデルを同時に利用する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="複数のリージョンのモデルを同時に利用する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#東京リージョンを優先しつつバージニア北部リージョンオレゴンリージョンの最新のモデルも使いたい場合" class="md-nav__link">
    <span class="md-ellipsis">
      東京リージョンを優先しつつ、バージニア北部リージョン・オレゴンリージョンの最新のモデルも使いたい場合
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-east-1-バージニア-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      us-east-1 (バージニア) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-west-2-オレゴン-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      us-west-2 (オレゴン) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-region-inference-が対応しているモデルで-us北部バージニアもしくはオレゴン-の-amazon-bedrock-のモデルを利用する場合" class="md-nav__link">
    <span class="md-ellipsis">
      cross-region inference が対応しているモデルで us(北部バージニアもしくはオレゴン) の Amazon Bedrock のモデルを利用する場合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ap-northeast-1-東京-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      ap-northeast-1 (東京) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-sagemaker-のカスタムモデルを利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon SageMaker のカスタムモデルを利用したい場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon SageMaker のカスタムモデルを利用したい場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#デプロイしたモデルを-genu-から呼び出す設定" class="md-nav__link">
    <span class="md-ellipsis">
      デプロイしたモデルを GenU から呼び出す設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#セキュリティ関連設定" class="md-nav__link">
    <span class="md-ellipsis">
      セキュリティ関連設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="セキュリティ関連設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#セルフサインアップを無効化する" class="md-nav__link">
    <span class="md-ellipsis">
      セルフサインアップを無効化する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#サインアップできるメールアドレスのドメインを制限する" class="md-nav__link">
    <span class="md-ellipsis">
      サインアップできるメールアドレスのドメインを制限する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-waf-による制限を有効化する" class="md-nav__link">
    <span class="md-ellipsis">
      AWS WAF による制限を有効化する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AWS WAF による制限を有効化する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-アドレスによる制限" class="md-nav__link">
    <span class="md-ellipsis">
      IP アドレスによる制限
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#地理的制限" class="md-nav__link">
    <span class="md-ellipsis">
      地理的制限
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saml-認証" class="md-nav__link">
    <span class="md-ellipsis">
      SAML 認証
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ガードレール" class="md-nav__link">
    <span class="md-ellipsis">
      ガードレール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#コスト関連設定" class="md-nav__link">
    <span class="md-ellipsis">
      コスト関連設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コスト関連設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kendraのインデックスを自動で作成削除するスケジュールを設定する" class="md-nav__link">
    <span class="md-ellipsis">
      Kendraのインデックスを自動で作成・削除するスケジュールを設定する
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#モニタリング用のダッシュボードの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      モニタリング用のダッシュボードの有効化
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#カスタムドメインの使用" class="md-nav__link">
    <span class="md-ellipsis">
      カスタムドメインの使用
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#別-aws-アカウントの-bedrock-を利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      別 AWS アカウントの Bedrock を利用したい場合
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#同一アカウントに複数環境デプロイする場合" class="md-nav__link">
    <span class="md-ellipsis">
      同一アカウントに複数環境デプロイする場合
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    認証
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            認証
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_WITH_GOOGLE_WORKSPACE.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Google Workspace で認証する
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SAML_WITH_ENTRA_ID.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Microsoft Entra ID で認証する
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    ブラウザ拡張機能
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            ブラウザ拡張機能
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="EXTENSION.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    概要
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="EXTENSION_BUILD.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ビルド
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="EXTENSION_INSTALL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    インストール
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="EXTENSION_SAML.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SAML 認証
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    その他
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            その他
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="UPDATE.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    アップデート方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DEVELOPMENT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ローカル開発環境構築手順
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DESTROY.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    リソースの削除方法
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PWA.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ネイティブアプリのように利用する方法
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#設定方法" class="md-nav__link">
    <span class="md-ellipsis">
      設定方法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="設定方法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameterts-の値を変更する方法" class="md-nav__link">
    <span class="md-ellipsis">
      parameter.ts の値を変更する方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cdkjson-の値を変更する方法" class="md-nav__link">
    <span class="md-ellipsis">
      cdk.json の値を変更する方法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ユースケースの設定" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースの設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ユースケースの設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rag-チャット-amazon-kendra-ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      RAG チャット (Amazon Kendra) ユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG チャット (Amazon Kendra) ユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#既存の-amazon-kendra-index-を利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      既存の Amazon Kendra Index を利用したい場合
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag-チャット-knowledge-base-ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      RAG チャット (Knowledge Base) ユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RAG チャット (Knowledge Base) ユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#advanced-parsing-を有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Parsing を有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#チャンク戦略を変更" class="md-nav__link">
    <span class="md-ellipsis">
      チャンク戦略を変更
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-vector-embedding-を有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Vector Embedding を有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-base-や-opensearch-service-を再作成して変更を加える" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Base や OpenSearch Service を再作成して変更を加える
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opensearch-service-の-index-をマネージメントコンソールで確認する方法" class="md-nav__link">
    <span class="md-ellipsis">
      OpenSearch Service の Index をマネージメントコンソールで確認する方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#メタデータフィルターの設定" class="md-nav__link">
    <span class="md-ellipsis">
      メタデータフィルターの設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-チャットユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Agent チャットユースケースの有効化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent チャットユースケースの有効化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code-interpreter-エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      Code Interpreter エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#検索エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      検索エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#手動で作成した-agent-を追加" class="md-nav__link">
    <span class="md-ellipsis">
      手動で作成した Agent を追加
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#knowledge-bases-for-amazon-bedrock-エージェントのデプロイ" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Bases for Amazon Bedrock エージェントのデプロイ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-をインライン表示にする" class="md-nav__link">
    <span class="md-ellipsis">
      Agent をインライン表示にする
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-チャットユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      Flow チャットユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#画像生成ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      画像生成ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#動画生成ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      動画生成ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#映像分析ユースケースの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      映像分析ユースケースの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#プロンプト最適化ツールの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      プロンプト最適化ツールの有効化
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#特定のユースケースを非表示にする" class="md-nav__link">
    <span class="md-ellipsis">
      特定のユースケースを非表示にする
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ユースケースビルダーの設定" class="md-nav__link">
    <span class="md-ellipsis">
      ユースケースビルダーの設定
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-bedrock-のモデルを変更する" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon Bedrock のモデルを変更する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon Bedrock のモデルを変更する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#複数のリージョンのモデルを同時に利用する" class="md-nav__link">
    <span class="md-ellipsis">
      複数のリージョンのモデルを同時に利用する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="複数のリージョンのモデルを同時に利用する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#東京リージョンを優先しつつバージニア北部リージョンオレゴンリージョンの最新のモデルも使いたい場合" class="md-nav__link">
    <span class="md-ellipsis">
      東京リージョンを優先しつつ、バージニア北部リージョン・オレゴンリージョンの最新のモデルも使いたい場合
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-east-1-バージニア-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      us-east-1 (バージニア) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#us-west-2-オレゴン-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      us-west-2 (オレゴン) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-region-inference-が対応しているモデルで-us北部バージニアもしくはオレゴン-の-amazon-bedrock-のモデルを利用する場合" class="md-nav__link">
    <span class="md-ellipsis">
      cross-region inference が対応しているモデルで us(北部バージニアもしくはオレゴン) の Amazon Bedrock のモデルを利用する場合
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ap-northeast-1-東京-の-amazon-bedrock-のモデルを利用する例" class="md-nav__link">
    <span class="md-ellipsis">
      ap-northeast-1 (東京) の Amazon Bedrock のモデルを利用する例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#amazon-sagemaker-のカスタムモデルを利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      Amazon SageMaker のカスタムモデルを利用したい場合
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Amazon SageMaker のカスタムモデルを利用したい場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#デプロイしたモデルを-genu-から呼び出す設定" class="md-nav__link">
    <span class="md-ellipsis">
      デプロイしたモデルを GenU から呼び出す設定
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#セキュリティ関連設定" class="md-nav__link">
    <span class="md-ellipsis">
      セキュリティ関連設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="セキュリティ関連設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#セルフサインアップを無効化する" class="md-nav__link">
    <span class="md-ellipsis">
      セルフサインアップを無効化する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#サインアップできるメールアドレスのドメインを制限する" class="md-nav__link">
    <span class="md-ellipsis">
      サインアップできるメールアドレスのドメインを制限する
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aws-waf-による制限を有効化する" class="md-nav__link">
    <span class="md-ellipsis">
      AWS WAF による制限を有効化する
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AWS WAF による制限を有効化する">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ip-アドレスによる制限" class="md-nav__link">
    <span class="md-ellipsis">
      IP アドレスによる制限
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#地理的制限" class="md-nav__link">
    <span class="md-ellipsis">
      地理的制限
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#saml-認証" class="md-nav__link">
    <span class="md-ellipsis">
      SAML 認証
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ガードレール" class="md-nav__link">
    <span class="md-ellipsis">
      ガードレール
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#コスト関連設定" class="md-nav__link">
    <span class="md-ellipsis">
      コスト関連設定
    </span>
  </a>
  
    <nav class="md-nav" aria-label="コスト関連設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kendraのインデックスを自動で作成削除するスケジュールを設定する" class="md-nav__link">
    <span class="md-ellipsis">
      Kendraのインデックスを自動で作成・削除するスケジュールを設定する
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#モニタリング用のダッシュボードの有効化" class="md-nav__link">
    <span class="md-ellipsis">
      モニタリング用のダッシュボードの有効化
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#カスタムドメインの使用" class="md-nav__link">
    <span class="md-ellipsis">
      カスタムドメインの使用
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#別-aws-アカウントの-bedrock-を利用したい場合" class="md-nav__link">
    <span class="md-ellipsis">
      別 AWS アカウントの Bedrock を利用したい場合
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#同一アカウントに複数環境デプロイする場合" class="md-nav__link">
    <span class="md-ellipsis">
      同一アカウントに複数環境デプロイする場合
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/docs/ja/DEPLOY_OPTION.md" title="編集" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/aws-samples/generative-ai-use-cases/raw/main/docs/ja/DEPLOY_OPTION.md" title="このページの原文を表示" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="デプロイオプション">デプロイオプション<a class="headerlink" href="#デプロイオプション" title="Permanent link">&para;</a></h1>
<h2 id="設定方法">設定方法<a class="headerlink" href="#設定方法" title="Permanent link">&para;</a></h2>
<p>GenU は、parameter.ts もしくは AWS CDK の context で設定を変更します。</p>
<p><strong>複数環境の設定を定義できるため、新規に構築する場合は parameter.ts での指定を推奨します。後方互換性のために context &gt; parameter.ts の順でパラメータを取得するようになっています。</strong></p>
<p><strong>Context を使う場合: CDK の context は '-c' でも指定できますが、その場合コードベースに変更が入らずフロントエンドのビルドが実施されないため、このアセットに関しては全ての設定は cdk.json の設定を変更することを推奨します。</strong></p>
<h3 id="parameterts-の値を変更する方法">parameter.ts の値を変更する方法<a class="headerlink" href="#parameterts-の値を変更する方法" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">packages/cdk/parameter.ts</a> の値を変更することで設定します。</p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    ragEnabled: false,
    // 他のパラメータも必要に応じてカスタマイズ
  },
  staging: {
    ragEnabled: false,
    // 他のパラメータも必要に応じてカスタマイズ
  },
  prod: {
    ragEnabled: true,
    // 他のパラメータも必要に応じてカスタマイズ
  },
};
</code></pre>
<p>CDK の context の <code>env</code> で指定した環境が <code>parameter.ts</code> で定義されている場合は、<code>parameter.ts</code> の値が優先されます。指定した <code>env</code> の環境が <code>parameter.ts</code> で定義されていない場合は、context の値で環境が作成されます。</p>
<p><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> の <code>context</code> で <code>env</code> を指定、もしくは <code>-c</code> で <code>env</code> を切り替えることが可能です。</p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;env&quot;: &quot;dev&quot;
  }
}
</code></pre>
<pre><code class="language-bash"># cdk.json の context.env で指定された env でデプロイ
npm run cdk:deploy

# 環境を prod に設定してデプロイ
npm run cdk:deploy -- -c env=prod
</code></pre>
<p>ローカルで開発する際は以下のように <code>env</code> を指定してください。</p>
<pre><code class="language-bash"># cdk.json の context.env で指定された env のバックエンドを使用してローカルで開発
npm run web:devw

# dev2 環境のバックエンドを使用してローカルで開発
npm run web:devw --env=dev2
</code></pre>
<h3 id="cdkjson-の値を変更する方法">cdk.json の値を変更する方法<a class="headerlink" href="#cdkjson-の値を変更する方法" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> の context 以下の値を変更することで設定します。例えば、<code>"ragEnabled": true</code> と設定することで RAG チャットのユースケースを有効化できます。context の値を設定した後、以下のコマンドで再度デプロイすることで設定が反映されます。</p>
<pre><code class="language-bash">npm run cdk:deploy
</code></pre>
<h2 id="ユースケースの設定">ユースケースの設定<a class="headerlink" href="#ユースケースの設定" title="Permanent link">&para;</a></h2>
<h3 id="rag-チャット-amazon-kendra-ユースケースの有効化">RAG チャット (Amazon Kendra) ユースケースの有効化<a class="headerlink" href="#rag-チャット-amazon-kendra-ユースケースの有効化" title="Permanent link">&para;</a></h3>
<p><code>ragEnabled</code> に <code>true</code> を指定します。(デフォルトは <code>false</code>)</p>
<p>また、<code>kendraIndexLanguage</code> (デフォルトは日本語の <code>ja</code>) も必要に応じて変更することが可能です。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    ragEnabled: true,
    kendraIndexLanguage: 'jp',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;ragEnabled&quot;: true,
    &quot;kendraIndexLanguage&quot;: &quot;jp&quot;
  }
}
</code></pre>
<p>変更後に <code>npm run cdk:deploy</code> で再度デプロイして反映させます。また、<code>/packages/cdk/rag-docs/docs</code> に保存されているデータが、自動で Kendra データソース用の S3 バケットにアップロードされます。(ただし <code>logs</code> から始まる名前のファイルは同期されませんので注意してください。)</p>
<p>続いて、Kendra の Data source の Sync を以下の手順で行ってください。</p>
<ol>
<li><a href="https://console.aws.amazon.com/kendra/home">Amazon Kendra のコンソール画面</a> を開く</li>
<li>generative-ai-use-cases-index をクリック</li>
<li>Data sources をクリック</li>
<li>「s3-data-source」をクリック</li>
<li>Sync now をクリック</li>
</ol>
<p>Sync run history の Status / Summary に Completed が表示されれば完了です。S3 に保存されているファイルが同期されて、Kendra から検索できるようになります。</p>
<h4 id="既存の-amazon-kendra-index-を利用したい場合">既存の Amazon Kendra Index を利用したい場合<a class="headerlink" href="#既存の-amazon-kendra-index-を利用したい場合" title="Permanent link">&para;</a></h4>
<p>既存の Kendra Index を利用する場合も、上記のように <code>ragEnabled</code> は <code>true</code> である必要がある点に注意してください。</p>
<p><code>kendraIndexArn</code> に Index の ARN を指定します。もし、既存の Kendra Index で S3 データソースを利用している場合は、<code>kendraDataSourceBucketName</code> にバケット名を指定します。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    kendraIndexArn: '&lt;Kendra Index ARN&gt;',
    kendraDataSourceBucketName: '&lt;Kendra S3 Data Source Bucket Name&gt;',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;kendraIndexArn&quot;: &quot;&lt;Kendra Index ARN&gt;&quot;,
    &quot;kendraDataSourceBucketName&quot;: &quot;&lt;Kendra S3 Data Source Bucket Name&gt;&quot;
  }
}
</code></pre>
<p>変更後に <code>npm run cdk:deploy</code> で再度デプロイして反映させます。</p>
<p><code>&lt;Kendra Index ARN&gt;</code> は以下のような形式です</p>
<pre><code>arn:aws:kendra:&lt;Region&gt;:&lt;AWS Account ID&gt;:index/&lt;Index ID&gt;
</code></pre>
<p>具体的には以下のような文字列です。</p>
<pre><code>arn:aws:kendra:ap-northeast-1:333333333333:index/77777777-3333-4444-aaaa-111111111111
</code></pre>
<h3 id="rag-チャット-knowledge-base-ユースケースの有効化">RAG チャット (Knowledge Base) ユースケースの有効化<a class="headerlink" href="#rag-チャット-knowledge-base-ユースケースの有効化" title="Permanent link">&para;</a></h3>
<p><code>ragKnowledgeBaseEnabled</code> に <code>true</code> を指定します。(デフォルトは <code>false</code>)<br />
作成ずみのKnowledge Baseがある場合、<code>ragKnowledgeBaseId</code> にナレッジベースIDを設定します。(<code>null</code>の場合、OpenSearch Serverlessのナレッジベースが作成されます)</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    ragKnowledgeBaseEnabled: true,
    ragKnowledgeBaseId: 'XXXXXXXXXX',
    ragKnowledgeBaseStandbyReplicas: false,
    ragKnowledgeBaseAdvancedParsing: false,
    ragKnowledgeBaseAdvancedParsingModelId:
      'anthropic.claude-3-sonnet-20240229-v1:0',
    ragKnowledgeBaseBinaryVector: false,
    embeddingModelId: 'amazon.titan-embed-text-v2:0',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;ragKnowledgeBaseEnabled&quot;: true,
    &quot;ragKnowledgeBaseId&quot;: &quot;XXXXXXXXXX&quot;,
    &quot;ragKnowledgeBaseStandbyReplicas&quot;: false,
    &quot;ragKnowledgeBaseAdvancedParsing&quot;: false,
    &quot;ragKnowledgeBaseAdvancedParsingModelId&quot;: &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
    &quot;ragKnowledgeBaseBinaryVector&quot;: false,
    &quot;embeddingModelId&quot;: &quot;amazon.titan-embed-text-v2:0&quot;,
    &quot;rerankingModelId&quot;: &quot;amazon.rerank-v1:0&quot;,
    &quot;queryDecompositionEnabled&quot;: true
  }
}
</code></pre>
<p><code>ragKnowledgeBaseStandbyReplicas</code> は自動作成される OpenSearch Serverless の冗長化に関する値です。</p>
<ul>
<li><code>false</code> : 開発およびテスト目的に適した指定。シングル AZ で稼働し、OCU のコストを半分にできる。</li>
<li><code>true</code> : 本番環境に適した設定。複数の AZ で稼働し、高可用性な構成が実現できる。</li>
</ul>
<p><code>embeddingModelId</code> は embedding に利用するモデルです。現状、以下モデルをサポートしています。</p>
<pre><code>&quot;amazon.titan-embed-text-v1&quot;
&quot;amazon.titan-embed-text-v2:0&quot;
&quot;cohere.embed-multilingual-v3&quot;
&quot;cohere.embed-english-v3&quot;
</code></pre>
<p><code>rerankingModelId</code> は reranking に利用するモデルです。現状、以下モデルをサポートしています。（デフォルトは <code>null</code>）</p>
<pre><code>&quot;amazon.rerank-v1:0&quot;
&quot;cohere.rerank-v3-5:0&quot;
</code></pre>
<p><code>queryDecompositionEnabled</code> は query decomposition を有効化するかどうかです。（デフォルトは <code>false</code>）</p>
<p>変更後に <code>npm run cdk:deploy</code> で再度デプロイして反映させます。この際、<code>modelRegion</code> で指定されているリージョンに Knowledge Base がデプロイされます。以下に注意してください。</p>
<ul>
<li><code>modelRegion</code> リージョンのモデルが 1 つ以上 <code>modelIds</code> に定義されている必要があります。</li>
<li><code>modelRegion</code> リージョンの Bedrock で <code>embeddingModelId</code> のモデルが有効化されている必要があります。</li>
<li><code>modelRegion</code> リージョンの Bedrock で <code>rerankingModelId</code> のモデルが有効化されている必要があります。</li>
<li><code>modelRegion</code> リージョンで <code>npm run cdk:deploy</code> の前に AWS CDK の Bootstrap が完了している必要があります。</li>
</ul>
<pre><code class="language-bash"># 以下はBootstrap するコマンドの例 (modelRegion が us-east-1 だとした場合)
npx -w packages/cdk cdk bootstrap --region us-east-1
</code></pre>
<p>デプロイ時に <code>/packages/cdk/rag-docs/docs</code> に保存されているデータが、自動で Knowledge Base データソース用の S3 バケットにアップロードされます。(ただし <code>logs</code> から始まる名前のファイルは同期されませんので注意してください。) デプロイ完了後、以下の手順で Knowledge Base の Data source を Sync してください。</p>
<ol>
<li><a href="https://console.aws.amazon.com/bedrock/home#/knowledge-bases">Knowledge Base のコンソール画面</a> を開く</li>
<li>generative-ai-use-cases-jp をクリック</li>
<li>s3-data-source を選択肢、Sync をクリック</li>
</ol>
<p>Status が Available になれば完了です。S3 に保存されているファイルが取り込まれており、Knowledge Base から検索できます。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RAG チャット (Knowledge Base) の設定を有効後に、再度無効化する場合は、<code>ragKnowledgeBaseEnabled: false</code> にして再デプロイすれば RAG チャット (Knowledge Base) は無効化されますが、<code>RagKnowledgeBaseStack</code> 自体は残ります。マネージメントコンソールを開き、modelRegion の CloudFormation から <code>RagKnowledgeBaseStack</code> というスタックを削除することで完全に消去ができます。</p>
</div>
<h4 id="advanced-parsing-を有効化">Advanced Parsing を有効化<a class="headerlink" href="#advanced-parsing-を有効化" title="Permanent link">&para;</a></h4>
<p><a href="https://docs.aws.amazon.com/bedrock/latest/userguide/kb-chunking-parsing.html#kb-advanced-parsing">Advanced Parsing 機能</a> を有効化できます。Advanced Parsing は、ファイル内の表やグラフなどの非構造化データから、情報を分析および抽出する機能です。ファイル内のテキストに加えて、表やグラフなどから抽出したデータを付け加えることで、RAG の精度を上げやすくするメリットがあります。</p>
<ul>
<li><code>ragKnowledgeBaseAdvancedParsing</code> : <code>true</code> で Advanced Parsing を有効化</li>
<li><code>ragKnowledgeBaseAdvancedParsingModelId</code> : 情報を抽出するときに利用するモデル ID を指定</li>
<li>サポートしているモデル (2024/08 現在)<ul>
<li><code>anthropic.claude-3-sonnet-20240229-v1:0</code></li>
<li><code>anthropic.claude-3-haiku-20240307-v1:0</code></li>
</ul>
</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    ragKnowledgeBaseEnabled: true,
    ragKnowledgeBaseId: 'XXXXXXXXXX',
    ragKnowledgeBaseStandbyReplicas: false,
    ragKnowledgeBaseAdvancedParsing: true,
    ragKnowledgeBaseAdvancedParsingModelId:
      'anthropic.claude-3-sonnet-20240229-v1:0',
    ragKnowledgeBaseBinaryVector: false,
    embeddingModelId: 'amazon.titan-embed-text-v2:0',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;ragKnowledgeBaseEnabled&quot;: true,
    &quot;ragKnowledgeBaseId&quot;: &quot;XXXXXXXXXX&quot;,
    &quot;ragKnowledgeBaseStandbyReplicas&quot;: false,
    &quot;ragKnowledgeBaseAdvancedParsing&quot;: true,
    &quot;ragKnowledgeBaseAdvancedParsingModelId&quot;: &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
    &quot;ragKnowledgeBaseBinaryVector&quot;: false,
    &quot;embeddingModelId&quot;: &quot;amazon.titan-embed-text-v2:0&quot;
  }
}
</code></pre>
<h4 id="チャンク戦略を変更">チャンク戦略を変更<a class="headerlink" href="#チャンク戦略を変更" title="Permanent link">&para;</a></h4>
<p><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/lib/rag-knowledge-base-stack.ts">rag-knowledge-base-stack.ts</a> に chunkingConfiguration を指定する箇所があります。
コメントアウトを外して、<a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_bedrock.CfnDataSource.ChunkingConfigurationProperty.html">CDK ドキュメント</a>や <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/kb-chunking-parsing.html">CloudFormation ドキュメント</a>を参考に任意のチャンク戦略へ変更が可能です。</p>
<p>例えば、セマンティックチャンクに変更する場合は、コメントアウトをはずして以下のように指定します。</p>
<pre><code class="language-typescript">// packages/cdk/lib/rag-knowledge-base-stack.ts
// セマンティックチャンク
chunkingConfiguration: {
  chunkingStrategy: 'SEMANTIC',
  semanticChunkingConfiguration: {
    maxTokens: 300,
    bufferSize: 0,
    breakpointPercentileThreshold: 95,
  },
},
</code></pre>
<p>その後、<a href="DEPLOY_OPTION.html#knowledge-base-や-opensearch-service-を再作成して変更を加える">Knowledge Base や OpenSearch Service を再作成して変更を加える</a>の章を参照して、変更を加えます。</p>
<h4 id="binary-vector-embedding-を有効化">Binary Vector Embedding を有効化<a class="headerlink" href="#binary-vector-embedding-を有効化" title="Permanent link">&para;</a></h4>
<p><a href="https://aws.amazon.com/jp/blogs/machine-learning/build-cost-effective-rag-applications-with-binary-embeddings-in-amazon-titan-text-embeddings-v2-amazon-opensearch-serverless-and-amazon-bedrock-knowledge-bases/">Binary Vector Embedding 機能</a> を有効化できます。Binary Vector Embedding は float（浮動小数点 32 bit）で表現していたベクトルデータを、binary（1 bit）で表現する機能です。バイナリ埋め込みは、ストレージ効率、計算速度、およびスケーラビリティに大きなメリットをもたらします。</p>
<ul>
<li><code>ragKnowledgeBaseBinaryVector</code> : <code>true</code> で Binary Vector Embedding を有効化</li>
<li><a href="https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base-supported.html#knowledge-base-supported-embeddings">サポートしているモデル</a> (2025/03 現在)<ul>
<li><code>amazon.titan-embed-text-v2:0</code></li>
<li><code>cohere.embed-multilingual-v3</code></li>
<li><code>cohere.embed-english-v3</code></li>
</ul>
</li>
</ul>
<h4 id="knowledge-base-や-opensearch-service-を再作成して変更を加える">Knowledge Base や OpenSearch Service を再作成して変更を加える<a class="headerlink" href="#knowledge-base-や-opensearch-service-を再作成して変更を加える" title="Permanent link">&para;</a></h4>
<p><a href="DEPLOY_OPTION.html#チャンク戦略を変更">Knowledge Base のチャンク戦略</a>や、OpenSearch Service に関する以下のパラメーターについて、変更を加えた後に <code>npm run cdk:deploy</code> を実行しても変更が反映されません。</p>
<ul>
<li><code>embeddingModelId</code></li>
<li><code>ragKnowledgeBaseStandbyReplicas</code></li>
<li><code>ragKnowledgeBaseAdvancedParsing</code></li>
<li><code>ragKnowledgeBaseAdvancedParsingModelId</code></li>
<li><code>ragKnowledgeBaseBinaryVector</code></li>
</ul>
<p>変更を反映する場合は、以下の手順で既存の Knowledge Base 関連のリソースを削除してから再作成を行います。</p>
<ol>
<li><code>ragKnowledgeBaseEnabled</code> を false にしてデプロイを行う</li>
<li><a href="https://console.aws.amazon.com/cloudformation/home">CloudFormation</a> (リージョンに注意) を開き、RagKnowledgeBaseStack クリック</li>
<li>右上の Delete をクリックして を開き、RagKnowledgeBaseStack を削除<br />
<strong>S3 バケットや RAG 用のファイルも含めて削除され、一時的に RAG チャットが利用不可になります</strong></li>
<li>パラメータやチャンク戦略に変更を加える</li>
<li>RagKnowledgeBaseStack の削除完了後、再度 <code>npm run cdk:deploy</code> でデプロイ</li>
</ol>
<p>RagKnowledgeBaseStack の削除に伴い、<strong>RAG チャット用の S3 バケットや格納されている RAG 用のファイルが削除</strong>されます。
S3 バケット内にアップロードした RAG 用のファイルが存在する場合は、退避したあとに再度アップロードしてください。
また、前述した手順に従い Data source を再度 Sync してください。</p>
<h4 id="opensearch-service-の-index-をマネージメントコンソールで確認する方法">OpenSearch Service の Index をマネージメントコンソールで確認する方法<a class="headerlink" href="#opensearch-service-の-index-をマネージメントコンソールで確認する方法" title="Permanent link">&para;</a></h4>
<p>デフォルトでは、マネージメントコンソールから OpenSearch Service の Indexes タブを開くと <code>User does not have permissions for the requested resource</code> というエラーが表示されます。
これは、Data access policy でマネージメントコンソールにログインしている IAM ユーザーを許可していないためです。
以下の手順に従い、必要な権限を手動で追加してください。</p>
<ol>
<li><a href="https://console.aws.amazon.com/aos/home?#opensearch/collections">OpenSearch Service</a> (リージョンに注意) を開き、generative-ai-use-cases-jp をクリック</li>
<li>ページ下部 Data access の Associated policy である generative-ai-use-cases-jp をクリック</li>
<li>右上の Edit をクリック</li>
<li>ページ中部の Select principals の Add principals をクリックし、IAM User/Role 等 (マネージメントコンソールにログインしている権限) を追加</li>
<li>Save</li>
</ol>
<p>保存後、少し時間をおいて再度アクセスしてください。</p>
<h4 id="メタデータフィルターの設定">メタデータフィルターの設定<a class="headerlink" href="#メタデータフィルターの設定" title="Permanent link">&para;</a></h4>
<p>フィルターの設定は <a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/common/src/custom/rag-knowledge-base.ts">packages/common/src/custom/rag-knowledge-base.ts</a> で行えます。必要に応じてカスタマイズしてご利用ください。</p>
<ul>
<li><code>dynamicFilters</code> : 動的にアプリケーション側でフィルタを作成して適用します。（例: ユーザーの部署などの属性に応じてフィルタを作成して適用する）現状 Claude Sonnet ３.5 のみ対応しています。（クォータによりスロットリングが発生することがあります）Cognito Group や SAML IdP の Group を Attribute にマッピングして利用することも可能です。（詳細は <a href="SAML_WITH_ENTRA_ID.html">Microsoft Entra ID と SAML 連携</a> を参照）</li>
<li><code>implicitFilters</code> : 指定されている場合は LLM がユーザーの質問に応じて指定されたメタデータに対してフィルタを作成して適用します。 (例: ユーザーの質問に含まれる年をフィルターに指定して、その年のデータのみを検索する) 空配列の場合はフィルタは適用されません。</li>
<li><code>hiddenStaticExplicitFilters</code> : アプリケーションレベルで適用したいフィルタを適用します。（例: データの分類が秘密のデータは除外する）</li>
<li><code>userDefinedExplicitFilters</code> : アプリケーションの UI にて表示されるフィルターを定義します。</li>
</ul>
<h3 id="agent-チャットユースケースの有効化">Agent チャットユースケースの有効化<a class="headerlink" href="#agent-チャットユースケースの有効化" title="Permanent link">&para;</a></h3>
<p>Agent チャットユースケースでは、以下のご利用が可能です。</p>
<ul>
<li>Code Interpreter を利用したデータの可視化、コード実行、データ分析</li>
<li>Agents for Amazon Bedrock を利用したアクションを実行</li>
<li>Knowledge Bases for Amazon Bedrock のベクトルデータベースを参照</li>
</ul>
<p>Agent は <code>modelRegion</code> で指定したリージョンに生成されます。後述する <code>agentEnabled: true</code> は Code Interpreter エージェントと検索エージェントを作成するためのオプションで、手動で作成した Agent を追加する際には <code>agentEnabled: true</code> である必要はありません。</p>
<h4 id="code-interpreter-エージェントのデプロイ">Code Interpreter エージェントのデプロイ<a class="headerlink" href="#code-interpreter-エージェントのデプロイ" title="Permanent link">&para;</a></h4>
<p>Code Interpreter を利用したデータの可視化、コード実行、データ分析などが実行できます。</p>
<p>Code Interpreter エージェントは Agent を有効化するとデプロイされます。</p>
<p><code>agentEnabled</code> に <code>true</code> を指定します。(デフォルトは <code>false</code>)</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    agentEnabled: true,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;agentEnabled&quot;: true
  }
}
</code></pre>
<h4 id="検索エージェントのデプロイ">検索エージェントのデプロイ<a class="headerlink" href="#検索エージェントのデプロイ" title="Permanent link">&para;</a></h4>
<p>API と連携し最新情報を参照して回答する Agent を作成します。Agent のカスタマイズを行い他のアクションを追加できるほか、複数の Agent を作成し切り替えることが可能です。</p>
<p>デフォルトで使用できる検索エージェントでは、無料利用枠の大きさ・リクエスト数の制限・コストの観点から <a href="https://brave.com/search/api/">Brave Search API の Data for AI</a> を使用していますが、他の API にカスタマイズすることも可能です。API キーの取得はフリープランでもクレジットカードの登録が必要になります。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Agent チャットユースケースを有効化すると Agent チャットユースケースでのみ外部 API にデータを送信します。（デフォルトでは Brave Search API）他のユースケースは引き続き AWS 内のみに閉じて利用することが可能です。社内ポリシー、API の利用規約などを確認してから有効化してください。</p>
</div>
<p><code>agentEnabled</code> と <code>searchAgentEnabled</code> に <code>true</code> を指定し(デフォルトは <code>false</code>)、<code>searchApiKey</code> に検索エンジンの API キーを指定します。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    agentEnabled: true,
    searchAgentEnabled: true,
    searchApiKey: '&lt;検索エンジンの API キー&gt;',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;agentEnabled&quot;: true,
    &quot;searchAgentEnabled&quot;: true,
    &quot;searchApiKey&quot;: &quot;&lt;検索エンジンの API キー&gt;&quot;
  }
}
</code></pre>
<p>変更後に <code>npm run cdk:deploy</code> で再度デプロイして反映させます。これにより、デフォルトの検索エンジン Agent がデプロイされます。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>検索エージェントの設定を有効後に、再度無効化する場合は、<code>searchAgentEnabled: false</code> にして再デプロイすれば検索エージェントは無効化されますが、<code>WebSearchAgentStack</code> 自体は残ります。マネージメントコンソールを開き、<code>modelRegion</code> の CloudFormation から <code>WebSearchAgentStack</code> というスタックを削除することで完全に消去ができます。</p>
</div>
<h4 id="手動で作成した-agent-を追加">手動で作成した Agent を追加<a class="headerlink" href="#手動で作成した-agent-を追加" title="Permanent link">&para;</a></h4>
<p>デフォルトの Agent 以外に手動で作成した Agent を登録したい場合、以下のように追加の Agent を <code>agents</code> に追加してください。Agent は <code>modelRegion</code> で作成する点に留意してください。</p>
<blockquote>
<p>[!NOTE] &gt; <code>agentEnabled: true</code> は Code Interpreter エージェントと検索エージェントを作成するためのオプションですので、手動で作成した Agent を追加する際には <code>agentEnabled: true</code> である必要はありません。</p>
</blockquote>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    agents: [
      {
        displayName: 'MyCustomAgent',
        agentId: 'XXXXXXXXX',
        aliasId: 'YYYYYYYY',
      },
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;agents&quot;: [
      {
        &quot;displayName&quot;: &quot;MyCustomAgent&quot;,
        &quot;agentId&quot;: &quot;XXXXXXXXX&quot;,
        &quot;aliasId&quot;: &quot;YYYYYYYY&quot;
      }
    ]
  }
}
</code></pre>
<p>また、<code>packages/cdk/lib/construct/agent.ts</code> を改修し新たな Agent を定義することも可能です。CDK に定義した Agent を利用する場合は <code>agentEnabled: true</code> にしてください。</p>
<h4 id="knowledge-bases-for-amazon-bedrock-エージェントのデプロイ">Knowledge Bases for Amazon Bedrock エージェントのデプロイ<a class="headerlink" href="#knowledge-bases-for-amazon-bedrock-エージェントのデプロイ" title="Permanent link">&para;</a></h4>
<p>Knowledge Bases for Amazon Bedrock と連携したエージェントを手動で作成し登録することも可能です。</p>
<p>まず、<a href="https://console.aws.amazon.com/bedrock/home?#/knowledge-bases">ナレッジベースの AWS コンソール画面</a> から<a href="https://docs.aws.amazon.com/ja_jp/bedrock/latest/userguide/knowledge-base-create.html">Knowledge Bases for Amazon Bedrock のドキュメント</a>を参考にナレッジベースを作成します。<code>modelRegion</code> と同じリージョンに作成してください。</p>
<p>続いて、 <a href="https://console.aws.amazon.com/bedrock/home?#/agents">エージェントの AWS コンソール画面</a> から手動で Agent を作成します。設定は基本的にデフォルトのままで、Agent のプロンプトは以下の例を参考にプロンプトを入力します。アクショングループは必要ないため設定せずに進み、ナレッジベースでは前のステップで作成したナレッジベースを登録し、プロンプトは以下の例を参考に入力します。</p>
<pre><code>Agent プロンプト例: あなたは指示に応えるアシスタントです。 指示に応じて情報を検索し、その内容から適切に回答してください。情報に記載のないものについては回答しないでください。複数回検索することが可能です。
Knowledge Base プロンプト例: キーワードで検索し情報を取得します。調査、調べる、Xについて教える、まとめるといったタスクで利用できます。会話から検索キーワードを推測してください。検索結果には関連度の低い内容も含まれているため関連度の高い内容のみを参考に回答してください。複数回実行可能です。
</code></pre>
<p>作成された Agent から Alias を作成し、<code>agentId</code> と <code>aliasId</code> をコピーし以下の形式で追加します。<code>displayName</code> は UI に表示したい名称を設定してください。また、<code>agentEnabled</code> を <code>true</code> にします。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    agentEnabled: true,
    agents: [
      {
        displayName: 'Knowledge Base',
        agentId: 'XXXXXXXXX',
        aliasId: 'YYYYYYYY',
      },
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;agentEnabled&quot;: true,
    &quot;agents&quot;: [
      {
        &quot;displayName&quot;: &quot;Knowledge Base&quot;,
        &quot;agentId&quot;: &quot;XXXXXXXXX&quot;,
        &quot;aliasId&quot;: &quot;YYYYYYYY&quot;
      }
    ]
  }
}
</code></pre>
<h4 id="agent-をインライン表示にする">Agent をインライン表示にする<a class="headerlink" href="#agent-をインライン表示にする" title="Permanent link">&para;</a></h4>
<p>Agent は、デフォルトでは「Agent チャット」というユースケースの中から Agent を選択する方式で利用できます。インライン表示のオプションを有効にすると、「Agent チャット」というユースケースは表示されなくなり、利用可能な全ての Agent が他のユースケースと同じように表示されるようになります。有効な Agent が存在する状態で、<code>inlineAgents</code> を <code>true</code> に設定してください。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    inlineAgents: true,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;inlineAgents&quot;: true
  }
}
</code></pre>
<h3 id="flow-チャットユースケースの有効化">Flow チャットユースケースの有効化<a class="headerlink" href="#flow-チャットユースケースの有効化" title="Permanent link">&para;</a></h3>
<p>Flow チャットユースケースでは、作成済みの Flow を呼び出すことができます。</p>
<p><code>flows</code> 配列を追加または編集します。</p>
<p><a href="https://console.aws.amazon.com/bedrock/home#/flows">Amazon Bedrock Flows の AWS コンソール画面</a> から手動で Flows を作成します。その後、Alias を作成し、作成済みの Flow の <code>flowId</code> と <code>aliasId</code>, <code>flowName</code> を追加します。<code>description</code> にはユーザーの入力を促すための説明文章を記載します。この説明文章は Flow チャットのテキストボックスに記載されます。以下はその例です。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    flows: [
      {
        flowId: 'XXXXXXXXXX',
        aliasId: 'YYYYYYYYYY',
        flowName: 'WhatIsItFlow',
        description:
          '任意のキーワードをウェブ検索して、説明を返すフローです。文字を入力してください',
      },
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;flows&quot;: [
      {
        &quot;flowId&quot;: &quot;XXXXXXXXXX&quot;,
        &quot;aliasId&quot;: &quot;YYYYYYYYYY&quot;,
        &quot;flowName&quot;: &quot;WhatIsItFlow&quot;,
        &quot;description&quot;: &quot;任意のキーワードをウェブ検索して、説明を返すフローです。文字を入力してください&quot;
      },
      {
        &quot;flowId&quot;: &quot;ZZZZZZZZZZ&quot;,
        &quot;aliasId&quot;: &quot;OOOOOOOOOO&quot;,
        &quot;flowName&quot;: &quot;RecipeFlow&quot;,
        &quot;description&quot;: &quot;与えられたJSONをもとに、レシピを作成します。\n{\&quot;dish\&quot;: \&quot;カレーライス\&quot;, \&quot;people\&quot;: 3} のように入力してください。&quot;
      },
      {
        &quot;flowId&quot;: &quot;PPPPPPPPPP&quot;,
        &quot;aliasId&quot;: &quot;QQQQQQQQQQQ&quot;,
        &quot;flowName&quot;: &quot;TravelPlanFlow&quot;,
        &quot;description&quot;: &quot;与えられた配列をもとに、旅行計画を作成します。\n[{\&quot;place\&quot;: \&quot;東京\&quot;, \&quot;day\&quot;: 3}, {\&quot;place\&quot;: \&quot;大阪\&quot;, \&quot;day\&quot;: 2}] のように入力してください。&quot;
      }
    ]
  }
}
</code></pre>
<h3 id="画像生成ユースケースの有効化">画像生成ユースケースの有効化<a class="headerlink" href="#画像生成ユースケースの有効化" title="Permanent link">&para;</a></h3>
<p><code>imageGenerationModelIds</code> にモデルを 1 つ以上定義すると有効化されます。
<code>imageGenerationModelIds</code> に関しては <a href="#amazon-bedrock-のモデルを変更する">Amazon Bedrock のモデルを変更する</a> をご参照ください。
デフォルト値は <a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/lib/stack-input.ts">packages/cdk/lib/stack-input.ts</a> をご参照ください。</p>
<h3 id="動画生成ユースケースの有効化">動画生成ユースケースの有効化<a class="headerlink" href="#動画生成ユースケースの有効化" title="Permanent link">&para;</a></h3>
<p><code>videoGenerationModelIds</code> にモデルを 1 つ以上定義すると有効化されます。
<code>videoGenerationModelIds</code> に関しては <a href="#amazon-bedrock-のモデルを変更する">Amazon Bedrock のモデルを変更する</a> をご参照ください。
デフォルト値は <a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/lib/stack-input.ts">packages/cdk/lib/stack-input.ts</a> をご参照ください。</p>
<h3 id="映像分析ユースケースの有効化">映像分析ユースケースの有効化<a class="headerlink" href="#映像分析ユースケースの有効化" title="Permanent link">&para;</a></h3>
<p>映像分析ユースケースでは、映像の画像フレームとテキストを入力して画像の内容を LLM に分析させます。
映像分析ユースケースを直接有効化するオプションはありませんが、パラメータでマルチモーダルのモデルが有効化されている必要があります。</p>
<p>2025/03 現在、マルチモーダルのモデルは以下です。</p>
<pre><code>&quot;anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
&quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;anthropic.claude-3-opus-20240229-v1:0&quot;,
&quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;us.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;us.anthropic.claude-3-opus-20240229-v1:0&quot;,
&quot;us.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;us.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;eu.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;eu.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;eu.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;apac.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;apac.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;apac.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;apac.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
&quot;us.meta.llama3-2-90b-instruct-v1:0&quot;,
&quot;us.meta.llama3-2-11b-instruct-v1:0&quot;,
&quot;us.mistral.pixtral-large-2502-v1:0&quot;,
&quot;eu.mistral.pixtral-large-2502-v1:0&quot;,
&quot;amazon.nova-pro-v1:0&quot;,
&quot;amazon.nova-lite-v1:0&quot;,
&quot;us.amazon.nova-pro-v1:0&quot;,
&quot;us.amazon.nova-lite-v1:0&quot;,
&quot;eu.amazon.nova-pro-v1:0&quot;,
&quot;eu.amazon.nova-lite-v1:0&quot;,
&quot;apac.amazon.nova-pro-v1:0&quot;,
&quot;apac.amazon.nova-lite-v1:0&quot;
</code></pre>
<p>これらのいずれかが <code>modelIds</code> に定義されている必要があります。
詳細は<a href="#amazon-bedrock-のモデルを変更する">Amazon Bedrock のモデルを変更する</a>を参照してください。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelIds: ['anthropic.claude-3-sonnet-20240229-v1:0'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelIds&quot;: [&quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;]
  }
}
</code></pre>
<h3 id="プロンプト最適化ツールの有効化">プロンプト最適化ツールの有効化<a class="headerlink" href="#プロンプト最適化ツールの有効化" title="Permanent link">&para;</a></h3>
<p>プロンプト最適化ツールは入力したプロンプトを指定したモデルに最適な形に変換します。
プロンプト最適化ツールを直接有効化するオプションはありませんが、パラメータの設定が以下の 2 点を満たす必要があります。</p>
<ul>
<li><code>modelRegion</code>: Amazon Bedrock の Prompt optimization がサポートされているリージョンであること</li>
<li><code>modelIds</code>: Amazon Bedrock の Prompt optimization がサポートされているモデルが 1 つ以上指定されていること</li>
</ul>
<p>Prompt optimization のサポート状況は <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/prompt-management-optimize.html">こちら</a> をご参照ください。</p>
<h3 id="特定のユースケースを非表示にする">特定のユースケースを非表示にする<a class="headerlink" href="#特定のユースケースを非表示にする" title="Permanent link">&para;</a></h3>
<p>以下のオプションで指定できるユースケースは非表示にできます。
特に指定がない場合や false を指定した場合は表示されます。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    hiddenUseCases: {
      generate: true, // 文章生成を非表示
      summarize: true, // 要約を非表示
      writer: true, // 執筆を非表示
      translate: true, // 翻訳を非表示
      webContent: true, // Web コンテンツ抽出を非表示
      image: true, // 画像生成を非表示
      video: true, // 動画生成を非表示
      videoAnalyzer: true, // 映像分析を非表示
      diagram: true, // ダイアグラム生成を非表示
    },
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;hiddenUseCases&quot;: {
      &quot;generate&quot;: true,
      &quot;summarize&quot;: true,
      &quot;writer&quot;: true,
      &quot;translate&quot;: true,
      &quot;webContent&quot;: true,
      &quot;image&quot;: true,
      &quot;video&quot;: true,
      &quot;videoAnalyzer&quot;: true,
      &quot;diagram&quot;: true
    }
  }
}
</code></pre>
<h2 id="ユースケースビルダーの設定">ユースケースビルダーの設定<a class="headerlink" href="#ユースケースビルダーの設定" title="Permanent link">&para;</a></h2>
<p>ユースケースビルダーはデフォルトで有効化されており、デプロイ後画面上に表示される「ビルダーモード」という項目から利用できます。ユースケースビルダーを無効化する場合は、パラメータの <code>useCaseBuilderEnabled</code> に <code>false</code> を指定します。(デフォルトは <code>true</code>)</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    useCaseBuilderEnabled: false,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;useCaseBuilderEnabled&quot;: false
  }
}
</code></pre>
<h2 id="amazon-bedrock-のモデルを変更する">Amazon Bedrock のモデルを変更する<a class="headerlink" href="#amazon-bedrock-のモデルを変更する" title="Permanent link">&para;</a></h2>
<p><code>parameter.ts</code> もしくは <code>cdk.json</code> の <code>modelRegion</code>, <code>modelIds</code>, <code>imageGenerationModelIds</code>, <code>videoGenerationModelIds</code> でモデルとモデルのリージョンを指定します。<code>modelIds</code> と <code>imageGenerationModelIds</code> と <code>videoGenerationModelIds</code> は指定したリージョンで利用できるモデルの中から利用したいモデルのリストで指定してください。AWS ドキュメントに、<a href="https://docs.aws.amazon.com/bedrock/latest/userguide/model-ids.html">モデルの一覧</a>と<a href="https://docs.aws.amazon.com/bedrock/latest/userguide/models-regions.html">リージョン別のモデルサポート一覧</a>があります。</p>
<p>また、<a href="https://docs.aws.amazon.com/bedrock/latest/userguide/cross-region-inference-support.html">cross-region inference</a>のモデルに対応しています。cross-region inference のモデルは <code>{us|eu|apac}.{model-provider}.{model-name}</code> で表されるモデルで、設定した modelRegion で指定したリージョンの <code>{us|eu|apac}</code> と一致している必要があります。</p>
<p>(例) <code>modelRegion</code> が <code>us-east-1</code> の場合、<code>us.anthropic.claude-3-5-sonnet-20240620-v1:0</code> は OK だが、<code>eu.anthropic.claude-3-5-sonnet-20240620-v1:0</code> は NG です。</p>
<p>このソリューションが対応しているテキスト生成モデルは以下です。</p>
<pre><code>&quot;anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
&quot;anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
&quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;anthropic.claude-3-opus-20240229-v1:0&quot;,
&quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;us.anthropic.claude-3-7-sonnet-20250219-v1:0&quot;,
&quot;us.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
&quot;us.anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
&quot;us.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;us.anthropic.claude-3-opus-20240229-v1:0&quot;,
&quot;us.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;us.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;eu.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;eu.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;eu.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;apac.anthropic.claude-3-haiku-20240307-v1:0&quot;,
&quot;apac.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
&quot;apac.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
&quot;apac.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
&quot;us.deepseek.r1-v1:0&quot;,
&quot;amazon.titan-text-premier-v1:0&quot;,
&quot;us.meta.llama3-3-70b-instruct-v1:0&quot;,
&quot;us.meta.llama3-2-90b-instruct-v1:0&quot;,
&quot;us.meta.llama3-2-11b-instruct-v1:0&quot;,
&quot;us.meta.llama3-2-3b-instruct-v1:0&quot;,
&quot;us.meta.llama3-2-1b-instruct-v1:0&quot;,
&quot;meta.llama3-1-405b-instruct-v1:0&quot;,
&quot;meta.llama3-1-70b-instruct-v1:0&quot;,
&quot;meta.llama3-1-8b-instruct-v1:0&quot;,
&quot;meta.llama3-70b-instruct-v1:0&quot;,
&quot;meta.llama3-8b-instruct-v1:0&quot;,
&quot;cohere.command-r-plus-v1:0&quot;,
&quot;cohere.command-r-v1:0&quot;,
&quot;mistral.mistral-large-2407-v1:0&quot;,
&quot;mistral.mistral-large-2402-v1:0&quot;,
&quot;mistral.mistral-small-2402-v1:0&quot;,
&quot;us.mistral.pixtral-large-2502-v1:0&quot;,
&quot;eu.mistral.pixtral-large-2502-v1:0&quot;,
&quot;anthropic.claude-v2:1&quot;,
&quot;anthropic.claude-v2&quot;,
&quot;anthropic.claude-instant-v1&quot;,
&quot;mistral.mixtral-8x7b-instruct-v0:1&quot;,
&quot;mistral.mistral-7b-instruct-v0:2&quot;,
&quot;amazon.nova-pro-v1:0&quot;,
&quot;amazon.nova-lite-v1:0&quot;,
&quot;amazon.nova-micro-v1:0&quot;,
&quot;us.amazon.nova-pro-v1:0&quot;,
&quot;us.amazon.nova-lite-v1:0&quot;,
&quot;us.amazon.nova-micro-v1:0&quot;,
&quot;eu.amazon.nova-pro-v1:0&quot;,
&quot;eu.amazon.nova-lite-v1:0&quot;,
&quot;eu.amazon.nova-micro-v1:0&quot;,
&quot;apac.amazon.nova-pro-v1:0&quot;,
&quot;apac.amazon.nova-lite-v1:0&quot;,
&quot;apac.amazon.nova-micro-v1:0&quot;
</code></pre>
<p>このソリューションが対応している画像生成モデルは以下です。</p>
<pre><code>&quot;amazon.nova-canvas-v1:0&quot;,
&quot;amazon.titan-image-generator-v2:0&quot;,
&quot;amazon.titan-image-generator-v1&quot;,
&quot;stability.sd3-large-v1:0&quot;,
&quot;stability.sd3-5-large-v1:0&quot;,
&quot;stability.stable-image-core-v1:0&quot;,
&quot;stability.stable-image-core-v1:1&quot;,
&quot;stability.stable-image-ultra-v1:0&quot;,
&quot;stability.stable-image-ultra-v1:1&quot;,
&quot;stability.stable-diffusion-xl-v1&quot;,
</code></pre>
<p>このソリューションが対応している動画生成モデルは以下です。</p>
<pre><code>&quot;amazon.nova-reel-v1:0&quot;,
&quot;luma.ray-v2:0&quot;
</code></pre>
<p><strong>指定したリージョンで指定したモデルが有効化されているかご確認ください。</strong></p>
<h3 id="複数のリージョンのモデルを同時に利用する">複数のリージョンのモデルを同時に利用する<a class="headerlink" href="#複数のリージョンのモデルを同時に利用する" title="Permanent link">&para;</a></h3>
<p>GenU では、特に指定がない限り<code>modelRegion</code>のモデルを使用します。一部リージョンのみで利用可能な最新モデル等を使いたい場合、<code>modelIds</code>または<code>imageGenerationModelIds</code>または<code>videoGenerationModelIds</code>に<code>{modelId: '&lt;モデル名&gt;', region: '&lt;リージョンコード&gt;'}</code>を指定することで、そのモデルのみ指定したリージョンから呼び出すことができます。</p>
<blockquote>
<p>[!NOTE] &gt; <a href="#モニタリング用のダッシュボードの有効化">モニタリング用ダッシュボード</a>と複数リージョンのモデル利用を併用する場合、デフォルトのダッシュボード設定では主リージョン（<code>modelRegion</code>で指定したリージョン）以外のモデルのプロンプトログが表示されません。</p>
<p>全リージョンのプロンプトログを一つのダッシュボード上で一覧したい場合は、以下の追加設定が必要です：</p>
<ol>
<li>各リージョンのAmazon Bedrock設定画面で「Model invocation logging」を手動で有効化する</li>
<li>CloudWatchダッシュボードに各リージョンのログを集計するウィジェットを追加する</li>
</ol>
</blockquote>
<h4 id="東京リージョンを優先しつつバージニア北部リージョンオレゴンリージョンの最新のモデルも使いたい場合">東京リージョンを優先しつつ、バージニア北部リージョン・オレゴンリージョンの最新のモデルも使いたい場合<a class="headerlink" href="#東京リージョンを優先しつつバージニア北部リージョンオレゴンリージョンの最新のモデルも使いたい場合" title="Permanent link">&para;</a></h4>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelRegion: 'ap-northeast-1',
    modelIds: [
      {
        modelId: 'us.anthropic.claude-3-7-sonnet-20250219-v1:0',
        region: 'us-east-1',
      },
      'apac.anthropic.claude-3-5-sonnet-20241022-v2:0',
      'anthropic.claude-3-5-sonnet-20240620-v1:0',
      {
        modelId: 'us.anthropic.claude-3-5-haiku-20241022-v1:0',
        region: 'us-east-1',
      },
      'apac.amazon.nova-pro-v1:0',
      'apac.amazon.nova-lite-v1:0',
      'apac.amazon.nova-micro-v1:0',
      { modelId: 'us.deepseek.r1-v1:0', region: 'us-east-1' },
      { modelId: 'us.meta.llama3-3-70b-instruct-v1:0', region: 'us-east-1' },
      { modelId: 'us.meta.llama3-2-90b-instruct-v1:0', region: 'us-east-1' },
      { modelId: 'us.mistral.pixtral-large-2502-v1:0', region: 'us-east-1' },
    ],
    imageGenerationModelIds: [
      'amazon.nova-canvas-v1:0',
      { modelId: 'stability.sd3-5-large-v1:0', region: 'us-west-2' },
      { modelId: 'stability.stable-image-core-v1:1', region: 'us-west-2' },
      { modelId: 'stability.stable-image-ultra-v1:1', region: 'us-west-2' },
    ],
    videoGenerationModelIds: [
      'amazon.nova-reel-v1:0',
      { modelId: 'luma.ray-v2:0', region: 'us-west-2' },
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;ap-northeast-1&quot;,
    &quot;modelIds&quot;: [
      {
        &quot;modelId&quot;: &quot;us.anthropic.claude-3-7-sonnet-20250219-v1:0&quot;,
        &quot;region&quot;: &quot;us-east-1&quot;
      },
      &quot;apac.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
      &quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      {
        &quot;modelId&quot;: &quot;us.anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
        &quot;region&quot;: &quot;us-east-1&quot;
      },
      &quot;apac.amazon.nova-pro-v1:0&quot;,
      &quot;apac.amazon.nova-lite-v1:0&quot;,
      &quot;apac.amazon.nova-micro-v1:0&quot;,
      {
        &quot;modelId&quot;: &quot;us.deepseek.r1-v1:0&quot;,
        &quot;region&quot;: &quot;us-east-1&quot;
      },
      {
        &quot;modelId&quot;: &quot;us.meta.llama3-3-70b-instruct-v1:0&quot;,
        &quot;region&quot;: &quot;us-east-1&quot;
      },
      {
        &quot;modelId&quot;: &quot;us.meta.llama3-2-90b-instruct-v1:0&quot;,
        &quot;region&quot;: &quot;us-east-1&quot;
      }
    ],
    &quot;imageGenerationModelIds&quot;: [
      &quot;amazon.nova-canvas-v1:0&quot;,
      {
        &quot;modelId&quot;: &quot;stability.sd3-5-large-v1:0&quot;,
        &quot;region&quot;: &quot;us-west-2&quot;
      },
      {
        &quot;modelId&quot;: &quot;stability.stable-image-core-v1:1&quot;,
        &quot;region&quot;: &quot;us-west-2&quot;
      },
      {
        &quot;modelId&quot;: &quot;stability.stable-image-ultra-v1:1&quot;,
        &quot;region&quot;: &quot;us-west-2&quot;
      }
    ],
    &quot;videoGenerationModelIds&quot;: [
      &quot;amazon.nova-reel-v1:0&quot;,
      {
        &quot;modelId&quot;: &quot;luma.ray-v2:0&quot;,
        &quot;region&quot;: &quot;us-west-2&quot;
      }
    ]
  }
}
</code></pre>
<h3 id="us-east-1-バージニア-の-amazon-bedrock-のモデルを利用する例">us-east-1 (バージニア) の Amazon Bedrock のモデルを利用する例<a class="headerlink" href="#us-east-1-バージニア-の-amazon-bedrock-のモデルを利用する例" title="Permanent link">&para;</a></h3>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelRegion: 'us-east-1',
    modelIds: [
      'anthropic.claude-3-5-sonnet-20240620-v1:0',
      'anthropic.claude-3-sonnet-20240229-v1:0',
      'anthropic.claude-3-haiku-20240307-v1:0',
      'amazon.nova-pro-v1:0',
      'amazon.nova-lite-v1:0',
      'amazon.nova-micro-v1:0',
      'amazon.titan-text-premier-v1:0',
      'meta.llama3-70b-instruct-v1:0',
      'meta.llama3-8b-instruct-v1:0',
      'cohere.command-r-plus-v1:0',
      'cohere.command-r-v1:0',
      'mistral.mistral-large-2402-v1:0',
    ],
    imageGenerationModelIds: [
      'amazon.nova-canvas-v1:0',
      'amazon.titan-image-generator-v2:0',
      'amazon.titan-image-generator-v1',
      'stability.stable-diffusion-xl-v1',
    ],
    videoGenerationModelIds: ['amazon.nova-reel-v1:0'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;us-east-1&quot;,
    &quot;modelIds&quot;: [
      &quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
      &quot;anthropic.claude-3-haiku-20240307-v1:0&quot;,
      &quot;amazon.nova-pro-v1:0&quot;,
      &quot;amazon.nova-lite-v1:0&quot;,
      &quot;amazon.nova-micro-v1:0&quot;,
      &quot;amazon.titan-text-premier-v1:0&quot;,
      &quot;meta.llama3-70b-instruct-v1:0&quot;,
      &quot;meta.llama3-8b-instruct-v1:0&quot;,
      &quot;cohere.command-r-plus-v1:0&quot;,
      &quot;cohere.command-r-v1:0&quot;,
      &quot;mistral.mistral-large-2402-v1:0&quot;
    ],
    &quot;imageGenerationModelIds&quot;: [
      &quot;amazon.nova-canvas-v1:0&quot;,
      &quot;amazon.titan-image-generator-v2:0&quot;,
      &quot;amazon.titan-image-generator-v1&quot;,
      &quot;stability.stable-diffusion-xl-v1&quot;
    ],
    &quot;videoGenerationModelIds&quot;: [&quot;amazon.nova-reel-v1:0&quot;]
  }
}
</code></pre>
<h3 id="us-west-2-オレゴン-の-amazon-bedrock-のモデルを利用する例">us-west-2 (オレゴン) の Amazon Bedrock のモデルを利用する例<a class="headerlink" href="#us-west-2-オレゴン-の-amazon-bedrock-のモデルを利用する例" title="Permanent link">&para;</a></h3>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelRegion: 'us-west-2',
    modelIds: [
      'anthropic.claude-3-5-sonnet-20241022-v2:0',
      'anthropic.claude-3-5-haiku-20241022-v1:0',
      'anthropic.claude-3-5-sonnet-20240620-v1:0',
      'anthropic.claude-3-opus-20240229-v1:0',
      'anthropic.claude-3-sonnet-20240229-v1:0',
      'anthropic.claude-3-haiku-20240307-v1:0',
      'meta.llama3-1-70b-instruct-v1:0',
      'meta.llama3-1-8b-instruct-v1:0',
      'cohere.command-r-plus-v1:0',
      'cohere.command-r-v1:0',
      'mistral.mistral-large-2407-v1:0',
    ],
    imageGenerationModelIds: [
      'amazon.titan-image-generator-v2:0',
      'amazon.titan-image-generator-v1',
      'stability.sd3-large-v1:0',
      'stability.sd3-5-large-v1:0',
      'stability.stable-image-core-v1:0',
      'stability.stable-image-core-v1:1',
      'stability.stable-image-ultra-v1:0',
      'stability.stable-image-ultra-v1:1',
      'stability.stable-diffusion-xl-v1',
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;us-west-2&quot;,
    &quot;modelIds&quot;: [
      &quot;anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
      &quot;anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
      &quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      &quot;anthropic.claude-3-opus-20240229-v1:0&quot;,
      &quot;anthropic.claude-3-sonnet-20240229-v1:0&quot;,
      &quot;anthropic.claude-3-haiku-20240307-v1:0&quot;,
      &quot;meta.llama3-1-70b-instruct-v1:0&quot;,
      &quot;meta.llama3-1-8b-instruct-v1:0&quot;,
      &quot;cohere.command-r-plus-v1:0&quot;,
      &quot;cohere.command-r-v1:0&quot;,
      &quot;mistral.mistral-large-2407-v1:0&quot;
    ],
    &quot;imageGenerationModelIds&quot;: [
      &quot;amazon.titan-image-generator-v2:0&quot;,
      &quot;amazon.titan-image-generator-v1&quot;,
      &quot;stability.sd3-large-v1:0&quot;,
      &quot;stability.sd3-5-large-v1:0&quot;
      &quot;stability.stable-image-core-v1:0&quot;,
      &quot;stability.stable-image-core-v1:1&quot;,
      &quot;stability.stable-image-ultra-v1:0&quot;,
      &quot;stability.stable-image-ultra-v1:1&quot;,
      &quot;stability.stable-diffusion-xl-v1&quot;,
    ],
  }
}
</code></pre>
<h3 id="cross-region-inference-が対応しているモデルで-us北部バージニアもしくはオレゴン-の-amazon-bedrock-のモデルを利用する場合">cross-region inference が対応しているモデルで us(北部バージニアもしくはオレゴン) の Amazon Bedrock のモデルを利用する場合<a class="headerlink" href="#cross-region-inference-が対応しているモデルで-us北部バージニアもしくはオレゴン-の-amazon-bedrock-のモデルを利用する場合" title="Permanent link">&para;</a></h3>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelRegion: 'us-east-2',
    modelIds: [
      &quot;us.anthropic.claude-3-7-sonnet-20250219-v1:0&quot;,
      &quot;us.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
      &quot;us.anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
      &quot;us.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      &quot;us.anthropic.claude-3-opus-20240229-v1:0&quot;,
      &quot;us.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
      &quot;us.anthropic.claude-3-haiku-20240307-v1:0&quot;,
      &quot;us.deepseek.r1-v1:0&quot;,
      &quot;us.meta.llama3-3-70b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-90b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-11b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-3b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-1b-instruct-v1:0&quot;,
      &quot;us.amazon.nova-pro-v1:0&quot;,
      &quot;us.amazon.nova-lite-v1:0&quot;,
      &quot;us.amazon.nova-micro-v1:0&quot;,
      &quot;cohere.command-r-plus-v1:0&quot;,
      &quot;cohere.command-r-v1:0&quot;,
      &quot;mistral.mistral-large-2407-v1:0&quot;,
    ],
    imageGenerationModelIds: [
      &quot;amazon.titan-image-generator-v2:0&quot;,
      &quot;amazon.titan-image-generator-v1&quot;,
      &quot;stability.sd3-large-v1:0&quot;,
      &quot;stability.sd3-5-large-v1:0&quot;
      &quot;stability.stable-image-core-v1:0&quot;,
      &quot;stability.stable-image-core-v1:1&quot;,
      &quot;stability.stable-image-ultra-v1:0&quot;,
      &quot;stability.stable-image-ultra-v1:1&quot;,
      &quot;stability.stable-diffusion-xl-v1&quot;,
    ],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;us-west-2&quot;,
    &quot;modelIds&quot;: [
      &quot;us.anthropic.claude-3-7-sonnet-20250219-v1:0&quot;,
      &quot;us.anthropic.claude-3-5-sonnet-20241022-v2:0&quot;,
      &quot;us.anthropic.claude-3-5-haiku-20241022-v1:0&quot;,
      &quot;us.anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      &quot;us.anthropic.claude-3-opus-20240229-v1:0&quot;,
      &quot;us.anthropic.claude-3-sonnet-20240229-v1:0&quot;,
      &quot;us.anthropic.claude-3-haiku-20240307-v1:0&quot;,
      &quot;us.deepseek.r1-v1:0&quot;,
      &quot;us.meta.llama3-3-70b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-90b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-11b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-3b-instruct-v1:0&quot;,
      &quot;us.meta.llama3-2-1b-instruct-v1:0&quot;,
      &quot;us.amazon.nova-pro-v1:0&quot;,
      &quot;us.amazon.nova-lite-v1:0&quot;,
      &quot;us.amazon.nova-micro-v1:0&quot;,
      &quot;cohere.command-r-plus-v1:0&quot;,
      &quot;cohere.command-r-v1:0&quot;,
      &quot;mistral.mistral-large-2407-v1:0&quot;
    ],
    &quot;imageGenerationModelIds&quot;: [
      &quot;amazon.titan-image-generator-v2:0&quot;,
      &quot;amazon.titan-image-generator-v1&quot;,
      &quot;stability.sd3-large-v1:0&quot;,
      &quot;stability.sd3-5-large-v1:0&quot;
      &quot;stability.stable-image-core-v1:0&quot;,
      &quot;stability.stable-image-core-v1:1&quot;,
      &quot;stability.stable-image-ultra-v1:0&quot;,
      &quot;stability.stable-image-ultra-v1:1&quot;,
      &quot;stability.stable-diffusion-xl-v1&quot;,
    ],
  }
}
</code></pre>
<h3 id="ap-northeast-1-東京-の-amazon-bedrock-のモデルを利用する例">ap-northeast-1 (東京) の Amazon Bedrock のモデルを利用する例<a class="headerlink" href="#ap-northeast-1-東京-の-amazon-bedrock-のモデルを利用する例" title="Permanent link">&para;</a></h3>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, StackInput&gt; = {
  dev: {
    modelRegion: 'ap-northeast-1',
    modelIds: [
      'anthropic.claude-3-5-sonnet-20240620-v1:0',
      'anthropic.claude-3-haiku-20240307-v1:0',
    ],
    imageGenerationModelIds: ['amazon.nova-canvas-v1:0'],
    videoGenerationModelIds: ['amazon.nova-reel-v1:0'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;ap-northeast-1&quot;,
    &quot;modelIds&quot;: [
      &quot;anthropic.claude-3-5-sonnet-20240620-v1:0&quot;,
      &quot;anthropic.claude-3-haiku-20240307-v1:0&quot;
    ],
    &quot;imageGenerationModelIds&quot;: [&quot;amazon.nova-canvas-v1:0&quot;],
    &quot;videoGenerationModelIds&quot;: [&quot;amazon.nova-reel-v1:0&quot;]
  }
}
</code></pre>
<h2 id="amazon-sagemaker-のカスタムモデルを利用したい場合">Amazon SageMaker のカスタムモデルを利用したい場合<a class="headerlink" href="#amazon-sagemaker-のカスタムモデルを利用したい場合" title="Permanent link">&para;</a></h2>
<p>Amazon SageMaker エンドポイントにデプロイされた大規模言語モデルを利用することが可能です。<a href="https://aws.amazon.com/blogs/machine-learning/announcing-the-launch-of-new-hugging-face-llm-inference-containers-on-amazon-sagemaker/">Text Generation Inference (TGI) の Hugging Face LLM 推論コンテナ</a> を使用した SageMaker Endpoint に対応しています。モデルはユーザーとアシスタントが交互に発言するチャット形式のプロンプトをサポートしているものが理想的です。現在、画像生成ユースケースは Amazon SageMaker エンドポイントに対応していないので、ご注意ください。</p>
<p>TGI コンテナを使用したモデルを SageMaker エンドポイントにデプロイする方法は現在2通りあります。</p>
<p><strong>SageMaker JumpStart で AWS が事前に用意したモデルをデプロイ</strong></p>
<p>SageMaker JumpStart では OSS の大規模言語モデルをワンクリックでデプロイできるようにパッケージングして提供しています。SageMaker Studio の JumpStart 画面からモデルを開き "デプロイ" ボタンをクリックしデプロイすることが可能です。提供している日本語モデルとしては例として以下のようなモデルを提供しています。</p>
<ul>
<li><a href="https://aws.amazon.com/jp/blogs/news/sagemaker-jumpstart-elyza-7b/">SageMaker JumpStart Elyza Japanese Llama 2 7B Instructt</a></li>
<li><a href="https://aws.amazon.com/jp/blogs/news/sagemaker-jumpstart-elyza-7b/">SageMaker JumpStart Elyza Japanese Llama 2 13B Instructt</a></li>
<li><a href="https://aws.amazon.com/jp/blogs/news/cyberagentlm2-on-sagemaker-jumpstart/">SageMaker JumpStart CyberAgentLM2 7B Chat</a></li>
<li><a href="https://aws.amazon.com/jp/blogs/news/japanese-stable-lm-instruct-alpha-7b-v2-from-stability-ai-is-now-available-in-amazon-sagemaker-jumpstart/">SageMaker JumpStart Stable LM Instruct Alpha 7B v2</a></li>
<li><a href="https://aws.amazon.com/jp/blogs/news/generative-ai-rinna-japanese-llm-on-amazon-sagemaker-jumpstart/">SageMaker JumpStart Rinna 3.6B</a></li>
<li><a href="https://aws.amazon.com/jp/blogs/news/generative-ai-rinna-japanese-llm-on-amazon-sagemaker-jumpstart/">SageMaker JumpStart Bilingual Rinna 4B</a></li>
</ul>
<p><strong>SageMaker SDK を使用して数行のコードでデプロイ</strong></p>
<p><a href="https://aws.amazon.com/jp/blogs/news/aws-and-hugging-face-collaborate-to-make-generative-ai-more-accessible-and-cost-efficient/">AWS と Hugging Face の提携</a>により、SageMaker SDK で Hugging Face に公開されているモデルの ID を指定するだけでモデルのデプロイが可能です。</p>
<p>公開されている Hugging Face のモデルページから <em>Deploy</em> &gt; <em>Amazon SageMaker</em> を選択するとモデルをデプロイするためのコードが表示されるため、こちらをコピーして実行すればモデルをデプロイすることが可能です。（モデルによりインスタンスサイズや <code>SM_NUM_GPUS</code> などのパラメータを変更する必要がある場合があります。デプロイに失敗した際は CloudWatch Logs からログを確認することが可能です）</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>デプロイする際、一箇所だけ修正点があります。エンドポイント名が GenU アプリケーションに表示されるほか、モデルのプロンプトテンプレート（次セクションにて説明）をエンドポイント名から判断しているためモデルを区別できるエンドポイント名を指定する必要があります。
 そのため、デプロイする際に <code>huggingface_model.deploy()</code> の引数に <code>endpoint_name="&lt;モデルを区別できるエンドポイント名&gt;"</code> を追加してください。</p>
</div>
<p><img alt="Hugging Face モデルページにて Deploy から Amazon SageMaker を選択" src="../assets/DEPLOY_OPTION/HF_Deploy.png" />
<img alt="Hugging Face モデルページのデプロイスクリプトのガイド" src="../assets/DEPLOY_OPTION/HF_Deploy2.png" /></p>
<h3 id="デプロイしたモデルを-genu-から呼び出す設定">デプロイしたモデルを GenU から呼び出す設定<a class="headerlink" href="#デプロイしたモデルを-genu-から呼び出す設定" title="Permanent link">&para;</a></h3>
<p>デプロイした SageMaker エンドポイントをターゲットのソリューションをデプロイする際は、以下のように指定することができます。</p>
<p>endpointNames は SageMaker エンドポイント名のリストです。（例：<code>["elyza-llama-2", "rinna"]</code>）</p>
<p>バックエンドでプロンプトを構築する際のプロンプトテンプレートを指定するために便宜上エンドポイント名の中にプロンプトの種類を含める必要があります。（例：<code>llama-2</code>、<code>rinna</code> など）詳しくは <code>packages/cdk/lambda/utils/models.ts</code> を参照してください。必要に応じてプロンプトテンプレートを追加してご利用ください。</p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    modelRegion: 'us-east-1',
    endpointNames: [
      'jumpstart-dft-hf-llm-rinna-3-6b-instruction-ppo-bf16',
      'jumpstart-dft-bilingual-rinna-4b-instruction-ppo-bf16',
    ],
  },
};
</code></pre>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;&lt;SageMaker Endpoint Region&gt;&quot;,
    &quot;endpointNames&quot;: [&quot;&lt;SageMaker Endpoint Name&gt;&quot;]
  }
}
</code></pre>
<p><strong>Rinna 3.6B と Bilingual Rinna 4B を利用する例</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;us-west-2&quot;,
    &quot;endpointNames&quot;: [
      &quot;jumpstart-dft-hf-llm-rinna-3-6b-instruction-ppo-bf16&quot;,
      &quot;jumpstart-dft-bilingual-rinna-4b-instruction-ppo-bf16&quot;
    ]
  }
}
</code></pre>
<p><strong>ELYZA-japanese-Llama-2-7b-instruct を利用する例</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;modelRegion&quot;: &quot;us-west-2&quot;,
    &quot;endpointNames&quot;: [&quot;elyza-japanese-llama-2-7b-inference&quot;]
  }
}
</code></pre>
<h2 id="セキュリティ関連設定">セキュリティ関連設定<a class="headerlink" href="#セキュリティ関連設定" title="Permanent link">&para;</a></h2>
<h3 id="セルフサインアップを無効化する">セルフサインアップを無効化する<a class="headerlink" href="#セルフサインアップを無効化する" title="Permanent link">&para;</a></h3>
<p><code>selfSignUpEnabled</code> に <code>false</code> を指定します。(デフォルトは <code>true</code>)</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    selfSignUpEnabled: false,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;selfSignUpEnabled&quot;: false
  }
}
</code></pre>
<h3 id="サインアップできるメールアドレスのドメインを制限する">サインアップできるメールアドレスのドメインを制限する<a class="headerlink" href="#サインアップできるメールアドレスのドメインを制限する" title="Permanent link">&para;</a></h3>
<p><code>allowedSignUpEmailDomains</code> に 許可するドメインのリストを指定します（デフォルトは<code>null</code>）。</p>
<p>値はstringのlist形式で指定し、各stringには"@"を含めないでください。メールアドレスのドメインが、許可ドメインのいずれか同じであればサインアップできます。<code>null</code> を指定すると何も制限されず、すべてのドメインを許可します。<code>[]</code> を指定するとすべて禁止し、どのドメインのメールアドレスでも登録できません。</p>
<p>設定すると、許可ドメインでないユーザは、Webのサインアップ画面で「アカウントを作る」を実行したときにエラーになり、GenU へのサインアップができなくなります。また、AWSマネジメントコンソールで、Cognitoのサービス画面から「ユーザを作成」を実行したときにエラーになります。</p>
<p>既にCognitoに作成されているユーザには影響ありません。新規にサインアップ・作成しようとしているユーザのみに適用されます。</p>
<p>設定例</p>
<ul>
<li><code>amazon.com</code> のドメインのメールアドレスであればサインアップできるように設定する例</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    allowedSignUpEmailDomains: ['amazon.com'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;allowedSignUpEmailDomains&quot;: [&quot;amazon.com&quot;] // null から、許可ドメインを指定することで有効化
  }
}
</code></pre>
<ul>
<li><code>amazon.com</code> か <code>amazon.jp</code> のどちらかのドメインのメールアドレスであればサインアップできるように設定する例</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    allowedSignUpEmailDomains: ['amazon.com', 'amazon.jp'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;allowedSignUpEmailDomains&quot;: [&quot;amazon.com&quot;, &quot;amazon.jp&quot;] // null から、許可ドメインを指定することで有効化
  }
}
</code></pre>
<h3 id="aws-waf-による制限を有効化する">AWS WAF による制限を有効化する<a class="headerlink" href="#aws-waf-による制限を有効化する" title="Permanent link">&para;</a></h3>
<h4 id="ip-アドレスによる制限">IP アドレスによる制限<a class="headerlink" href="#ip-アドレスによる制限" title="Permanent link">&para;</a></h4>
<p>Web アプリへのアクセスを IP アドレスで制限したい場合、AWS WAF による IP アドレス制限を有効化することができます。 <code>allowedIpV4AddressRanges</code> では許可する IPv4 の CIDR を配列で指定することができ、<code>allowedIpV6AddressRanges</code> では許可する IPv6 の CIDR を配列で指定することができます。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    allowedIpV4AddressRanges: ['192.168.0.0/24'],
    allowedIpV6AddressRanges: ['2001:0db8::/32'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;allowedIpV4AddressRanges&quot;: [&quot;192.168.0.0/24&quot;], // null から、許可 CIDR リストを指定することで有効化
    &quot;allowedIpV6AddressRanges&quot;: [&quot;2001:0db8::/32&quot;] // null から、許可 CIDR リストを指定することで有効化
  }
}
</code></pre>
<h4 id="地理的制限">地理的制限<a class="headerlink" href="#地理的制限" title="Permanent link">&para;</a></h4>
<p>Web アプリへのアクセスをアクセス元の国で制限したい場合、AWS WAF による地理的制限を有効化することができます。 <code>allowedCountryCodes</code> で許可する国を Country Code の配列で指定することができます。
指定する国の Country Code は<a href="https://en.wikipedia.org/wiki/ISO_3166-2">ISO 3166-2 from wikipedia</a>をご参照ください。</p>
<p>「IP アドレスによる制限」も同時に設定している場合は、「送信元の IP アドレスが許可された IP アドレスに含まれている<strong>かつ</strong>、許可された国からのアクセス」のみ許可されます。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    allowedCountryCodes: ['JP'],
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;allowedCountryCodes&quot;: [&quot;JP&quot;] // null から、許可国リストを指定することで有効化
  }
}
</code></pre>
<p><code>allowedIpV4AddressRanges</code> あるいは <code>allowedIpV6AddressRanges</code> あるいは <code>allowedCountryCodes</code> のいずれかを指定して再度 <code>npm run cdk:deploy</code> を実行すると、WAF 用のスタックが us-east-1 にデプロイされます（AWS WAF V2 は CloudFront に使用する場合、us-east-1 のみしか現状対応していません）。us-east-1 で CDK を利用したことがない場合は、以下のコマンドを実行して、デプロイ前に Bootstrap を行ってください。</p>
<pre><code class="language-bash">npx -w packages/cdk cdk bootstrap --region us-east-1
</code></pre>
<h3 id="saml-認証">SAML 認証<a class="headerlink" href="#saml-認証" title="Permanent link">&para;</a></h3>
<p>Google Workspace や Microsoft Entra ID (旧 Azure Active Directory) などの IdP が提供する SAML 認証機能と連携ができます。次に詳細な連携手順があります。こちらもご活用ください。</p>
<ul>
<li><a href="SAML_WITH_GOOGLE_WORKSPACE.html">Google Workspace と SAML 連携</a></li>
<li><a href="SAML_WITH_ENTRA_ID.html">Microsoft Entra ID と SAML 連携</a></li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    samlAuthEnabled: true,
    samlCognitoDomainName:
      'your-preferred-name.auth.ap-northeast-1.amazoncognito.com',
    samlCognitoFederatedIdentityProviderName: 'EntraID',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;samlAuthEnabled&quot;: true,
    &quot;samlCognitoDomainName&quot;: &quot;your-preferred-name.auth.ap-northeast-1.amazoncognito.com&quot;,
    &quot;samlCognitoFederatedIdentityProviderName&quot;: &quot;EntraID&quot;
  }
}
</code></pre>
<ul>
<li>samlAuthEnabled : <code>true</code> にすることで、SAML 専用の認証画面に切り替わります。Cognito user pools を利用した従来の認証機能は利用できなくなります。</li>
<li>samlCognitoDomainName : Cognito の App integration で設定する Cognito Domain 名を指定します。</li>
<li>samlCognitoFederatedIdentityProviderName : Cognito の Sign-in experience で設定する Identity Provider の名前を指定します。</li>
</ul>
<h3 id="ガードレール">ガードレール<a class="headerlink" href="#ガードレール" title="Permanent link">&para;</a></h3>
<p>Converse API を使う(=テキスト出力を行う生成 AI モデル)場合はガードレールを適用させることが可能です。設定するには <code>guardrailEnabled</code> を <code>true</code> に変更しデプロイしなおします。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    guardrailEnabled: true,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;guardrailEnabled&quot;: true
  }
}
</code></pre>
<p>デフォルトで適用されるガードレールは機微情報フィルターで日本語での会話の中で効果があったものを適用しています。他にも単語フィルターのカスタム、機微情報フィルターの正規表現は機能することを確認しており、必要に応じて、<code>packages/cdk/lib/construct/guardrail.ts</code> を修正してください。詳細は<a href="https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails.html">Guardrails for Amazon Bedrock</a>と<a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_bedrock.CfnGuardrail.html">CfnGuardrail</a>をご参照ください。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ガードレールの設定を有効後に、再度無効化する場合は、<code>guardrailEnabled: false</code> にして再デプロイすれば生成 AI を呼び出す際にガードレールは無効化されますが、ガードレール自体は残ります。マネージメントコンソールを開き、modelRegion の CloudFormation から <code>GuardrailStack</code> というスタックを削除することで完全に消去ができます。ガードレールが残ること自体にコストは発生しませんが、使用しないリソースは削除するのが望ましいです。</p>
</div>
<h2 id="コスト関連設定">コスト関連設定<a class="headerlink" href="#コスト関連設定" title="Permanent link">&para;</a></h2>
<h3 id="kendraのインデックスを自動で作成削除するスケジュールを設定する">Kendraのインデックスを自動で作成・削除するスケジュールを設定する<a class="headerlink" href="#kendraのインデックスを自動で作成削除するスケジュールを設定する" title="Permanent link">&para;</a></h3>
<p>GenerativeAiUseCasesDashboardStack で作成する Kendra のインデックスを、決められたスケジュールで自動で作成・削除するための設定を行います。これによって、Kendraのインデックスを稼働時間に対して発生する利用料を抑えることができます。Kendraインデックスを作成した後は、本リポジトリでデフォルトで作成されるS3データソースに対して、同期を自動で実行します。</p>
<p>この機能は、「<code>ragEnabled</code> が <code>true</code> 」かつ「<code>kendraIndexArn</code> が <code>null</code> 」の場合にのみ有効で、それ以外の場合は機能しません。（つまり、外部で作成したKendraのインデックスに対しては機能しません）</p>
<p>以下の例のように設定してください。</p>
<ul>
<li><code>kendraIndexScheduleEnabled</code>を<code>true</code>に設定することで、スケジュール設定を有効になり、<code>false</code>にした場合、その状態でデプロイした以降は、スケジュール設定が無効になります。</li>
<li><code>kendraIndexScheduleCreateCron</code>と<code>kendraIndexScheduleDeleteCron</code>には、作成開始時刻と削除開始時刻をCron形式で指定します。</li>
<li>Cron形式の詳細は<a href="https://docs.aws.amazon.com/ja_jp/AmazonCloudWatch/latest/events/ScheduledEvents.html">こちら</a>を参照してください。ただし、EventBridgeの仕様に合わせるため、UTC時間で指定してください。現状では、minute・hour・month・weekDayのみ指定可能です。これら項目は必ず指定する必要があり、それ以外の項目は指定しても無視されます。</li>
<li><code>null</code>を設定した場合は、作成・削除が実行されません。片方を<code>null</code>のままにする（どちらかのみを設定する）ことも、両者を<code>null</code>にする（何も実行しない）ことも可能です。</li>
</ul>
<p>下記の例は、日本時間の月～金08:00にインデックスの作成を開始し、日本時間の月～金の20:00にインデックスの削除を開始する場合の設定です。</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    kendraIndexScheduleEnabled: true,
    kendraIndexScheduleCreateCron: {
      minute: '0',
      hour: '23',
      month: '*',
      weekDay: 'SUN-THU',
    },
    kendraIndexScheduleDeleteCron: {
      minute: '0',
      hour: '11',
      month: '*',
      weekDay: 'MON-FRI',
    },
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;kendraIndexScheduleEnabled&quot;: true,
    &quot;kendraIndexScheduleCreateCron&quot;: {
      &quot;minute&quot;: &quot;0&quot;,
      &quot;hour&quot;: &quot;23&quot;,
      &quot;month&quot;: &quot;*&quot;,
      &quot;weekDay&quot;: &quot;SUN-THU&quot;
    },
    &quot;kendraIndexScheduleDeleteCron&quot;: {
      &quot;minute&quot;: &quot;0&quot;,
      &quot;hour&quot;: &quot;11&quot;,
      &quot;month&quot;: &quot;*&quot;,
      &quot;weekDay&quot;: &quot;MON-FRI&quot;
    }
  }
}
</code></pre>
<p>Kendraのインデックスが削除されても、RAG機能はオンのままです。Webアプリケーション（GenU）ではRAG関連のメニューは表示されたままです。RAGチャットを実行すると、インデックスが存在しないためエラーが発生し、エラーメッセージに「インデックス作成・削除のスケジュールを確認してください」という旨のテキストが表示されます。</p>
<p>スケジュールとしてEventBridgeルールを使用し、処理の制御としてStep Functionsを使用します。EventBridgeのルールを手動で無効化することでスケジュールを停止できます。また、Step Functionsのステートマシンを手動で実行することで、インデックスの作成・削除を行うことができます。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>インデックス再作成後、追加されるデータソースは、デフォルトで作成されるS3データソースのみです。</li>
<li>インデックス作成後に他のデータソースを追加していた場合、インデックス削除時にデータソースも削除され、インデックスを再作成してもそれらのデータソースは作成されず、再度追加する必要があります。</li>
<li>本リポジトリのCDK内でデータソースを追加した場合、データソースの作成はされますが、同期はされません。CDKで追加したデータソースの同期を行うためには、手動でデータソースの同期を行うか、Step Functionsのステートマシンのターゲットとして追加するように<a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/lib/construct/rag.ts">コード</a>を修正する必要があります。</li>
<li>Kendraのインデックス作成を開始してから、利用可能な状態になるまでには時間がかかります。具体的には、インデックスの作成と、データソースの同期に時間がかかります。そのため、 <strong>RAGチャットの利用を開始したい時刻が決まっている場合、設定する起動時刻はそれよりも前に設定してください</strong> 。リソースの空き状況・データソースの種類・データソース内のドキュメントのサイズ・数によって変動しますので、厳密な稼働時間を設定したい場合は、実際の所要時間を確認して設定するようにしてください。</li>
<li>おおよその目安として、インデックスの作成には30分程度、S3データソースに数百件のテキストファイルを配置した場合、データソースの同期には10分程度かかります（あくまで目安です）。（この値に合わせるなら、40分前に設定する、ということになります。）</li>
<li>特に外部サービスをデータソースとして利用する場合は、所要時間が大きく変動することが予想されるため、注意してください。また、APIのコール制限などにも注意してください。</li>
<li>上記の設定時間外にインデックスが停止されていることを保証するものではなく、あくまでスケジュールで起動・停止を実行するものです。デプロイやスケジュールのタイミングにご注意ください</li>
<li>例えば、20時に削除する設定を、21時にデプロイしても、その時点では削除されず、翌日の21時にならないと削除が開始されません。</li>
<li>スタックを作成するとき（GenerativeAiUseCasesStackがない状態で、cdk:deployを実行したとき）は、<code>ragEnabled</code>が<code>true</code>の場合、Kendraインデックスが作成されます。スケジュールの時刻が設定されていても、作成されます。次の削除スケジュール時刻まで、インデックスは作成されたままです。</li>
<li>現状では、起動・停止のエラーを通知する機能はありません。</li>
<li>インデックスを再作成するたびに、IndexIdやDataSourceIdが変わります。他のサービスなどから参照している場合は、その変更に対応する必要があります。</li>
</ul>
</div>
<h2 id="モニタリング用のダッシュボードの有効化">モニタリング用のダッシュボードの有効化<a class="headerlink" href="#モニタリング用のダッシュボードの有効化" title="Permanent link">&para;</a></h2>
<p>入力/出力 Token 数や直近のプロンプト集などが集約されたダッシュボードを作成します。
<strong>ダッシュボードは GenU に組み込まれたものではなく、Amazon CloudWatch のダッシュボードです。</strong>
Amazon CloudWatch のダッシュボードは、<a href="https://console.aws.amazon.com/cloudwatch/home#dashboards">マネージメントコンソール</a>から閲覧できます。
ダッシュボードを閲覧するには、マネージメントコンソールにログイン可能かつダッシュボードが閲覧可能な権限を持った IAM ユーザーの作成が必要です。</p>
<p><code>dashboard</code> に <code>true</code> を設定します。(デフォルトは <code>false</code>)</p>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    dashboard: true,
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;dashboard&quot;: true
  }
}
</code></pre>
<p>変更後に <code>npm run cdk:deploy</code> で再度デプロイして反映させます。<code>modelRegion</code> に指定されたリージョンに <code>GenerativeAiUseCasesDashboardStack</code> という名前の Stack がデプロイされます。出力された値はこの後の手順で利用します。</p>
<p>続いて、Amazon Bedrock のログの出力を設定します。<a href="https://console.aws.amazon.com/bedrock/home#settings">Amazon Bedrock の Settings</a> を開き、Model invocation logging を有効化します。Select the logging destinations には CloudWatch Logs only を選択してください。(S3 にも出力したい場合、Both S3 and CloudWatch Logs を選択しても構いません。) また、Log group name には <code>npm run cdk:deploy</code> 時に出力された <code>GenerativeAiUseCasesDashboardStack.BedrockLogGroup</code> を指定してください。(例: <code>GenerativeAiUseCasesDashboardStack-LogGroupAAAAAAAA-BBBBBBBBBBBB</code>) Service role は任意の名前で新規に作成してください。なお、Model invocation logging の設定は、 <code>modelRegion</code> として指定しているリージョンで行うことに留意してください。</p>
<p>設定完了後、<code>npm run cdk:deploy</code> 時に出力された <code>GenerativeAiUseCasesDashboardStack.DashboardUrl</code> を開いてください。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>モニタリング用のダッシュボードを有効後に、再度無効化する場合は、<code>dashboard: false</code> にして再デプロイすればモニタリング用ダッシュボードは無効化されますが、<code>GenerativeAiUseCasesDashboardStack</code> 自体は残ります。マネージメントコンソールを開き、modelRegion の CloudFormation から <code>GenerativeAiUseCasesDashboardStack</code> というスタックを削除することで完全に消去ができます。</p>
</div>
<h2 id="カスタムドメインの使用">カスタムドメインの使用<a class="headerlink" href="#カスタムドメインの使用" title="Permanent link">&para;</a></h2>
<p>Web サイトの URL としてカスタムドメインを使用することができます。同一 AWS アカウントの Route53 にパブリックホストゾーンが作成済みであることが必要です。パブリックホストゾーンについてはこちらをご参照ください: <a href="https://docs.aws.amazon.com/ja_jp/Route53/latest/DeveloperGuide/AboutHZWorkingWith.html">パブリックホストゾーンの使用 - Amazon Route 53</a></p>
<p>同一 AWS アカウントにパブリックホストゾーンを持っていない場合は、AWS ACM による SSL 証明書の検証時に手動で DNS レコードを追加する方法や、Eメール検証を行う方法もあります。これらの方法を利用する場合は、CDK のドキュメントを参照してカスタマイズしてください: <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_certificatemanager-readme.html">aws-cdk-lib.aws_certificatemanager module · AWS CDK</a></p>
<p>以下の値を設定します。</p>
<ul>
<li><code>hostName</code> ... Web サイトのホスト名です。A レコードは CDK によって作成されます。事前に作成する必要はありません</li>
<li><code>domainName</code> ... 事前に作成したパブリックホストゾーンのドメイン名です</li>
<li><code>hostedZoneId</code> ... 事前に作成したパブリックホストゾーンのIDです</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    hostName: 'genai',
    domainName: 'example.com',
    hostedZoneId: 'XXXXXXXXXXXXXXXXXXXX',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;hostName&quot;: &quot;genai&quot;,
    &quot;domainName&quot;: &quot;example.com&quot;,
    &quot;hostedZoneId&quot;: &quot;XXXXXXXXXXXXXXXXXXXX&quot;
  }
}
</code></pre>
<h2 id="別-aws-アカウントの-bedrock-を利用したい場合">別 AWS アカウントの Bedrock を利用したい場合<a class="headerlink" href="#別-aws-アカウントの-bedrock-を利用したい場合" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Agent 系のタスク (Agent, Flow, プロンプト最適化ツール) に関しては別 AWS アカウントの利用をサポートしていないため、実行時にエラーになる可能性があります。</p>
</div>
<p>別 AWS アカウントの Bedrock を利用することができます。前提条件として、GenU の初回デプロイは完了済みとします。</p>
<p>別 AWS アカウントの Bedrock を利用するためには、別 AWS アカウントに IAM ロールを 1 つ作成する必要があります。作成する IAM ロール名は任意ですが、GenU デプロイ時に作成された以下の名前で始まる IAM ロール名を、別アカウントで作成した IAM ロールの Principal に指定します。</p>
<ul>
<li><code>GenerativeAiUseCasesStack-APIPredictTitleService</code></li>
<li><code>GenerativeAiUseCasesStack-APIPredictService</code></li>
<li><code>GenerativeAiUseCasesStack-APIPredictStreamService</code></li>
<li><code>GenerativeAiUseCasesStack-APIGenerateImageService</code></li>
</ul>
<p>Principal の指定方法について詳細を確認したい場合はこちらを参照ください: <a href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_elements_principal.html">AWS JSON ポリシーの要素: Principal</a></p>
<p>Principal 設定例 (別アカウントにて設定)</p>
<pre><code class="language-json">{
  &quot;Version&quot;: &quot;2012-10-17&quot;,
  &quot;Statement&quot;: [
    {
      &quot;Effect&quot;: &quot;Allow&quot;,
      &quot;Principal&quot;: {
        &quot;AWS&quot;: [
          &quot;arn:aws:iam::111111111111:role/GenerativeAiUseCasesStack-APIPredictTitleServiceXXX-XXXXXXXXXXXX&quot;,
          &quot;arn:aws:iam::111111111111:role/GenerativeAiUseCasesStack-APIPredictServiceXXXXXXXX-XXXXXXXXXXXX&quot;,
          &quot;arn:aws:iam::111111111111:role/GenerativeAiUseCasesStack-APIPredictStreamServiceXX-XXXXXXXXXXXX&quot;,
          &quot;arn:aws:iam::111111111111:role/GenerativeAiUseCasesStack-APIGenerateImageServiceXX-XXXXXXXXXXXX&quot;
        ]
      },
      &quot;Action&quot;: &quot;sts:AssumeRole&quot;,
      &quot;Condition&quot;: {}
    }
  ]
}
</code></pre>
<p>パラメータには以下の値を設定します。</p>
<ul>
<li><code>crossAccountBedrockRoleArn</code> ... 別アカウントで事前に作成した IAM ロールの ARN です</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/parameter.ts">parameter.ts</a> を編集</strong></p>
<pre><code class="language-typescript">// parameter.ts
const envs: Record&lt;string, Partial&lt;StackInput&gt;&gt; = {
  dev: {
    crossAccountBedrockRoleArn:
      'arn:aws:iam::アカウントID:role/事前に作成したロール名',
  },
};
</code></pre>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;crossAccountBedrockRoleArn&quot;: &quot;arn:aws:iam::アカウントID:role/事前に作成したロール名&quot;
  }
}
</code></pre>
<p>設定変更後に <code>npm run cdk:deploy</code> を実行して変更内容を反映させます。</p>
<h2 id="同一アカウントに複数環境デプロイする場合">同一アカウントに複数環境デプロイする場合<a class="headerlink" href="#同一アカウントに複数環境デプロイする場合" title="Permanent link">&para;</a></h2>
<p>同一アカウントで複数環境をデプロイする場合、異なる名前のスタックでデプロイする必要があります。</p>
<p><code>env</code> を設定すると各スタックの Suffix として付与され別環境としてデプロイされます。</p>
<p><code>env</code> は <code>parameter.ts</code> の環境判定にも利用されており、<code>parameter.ts</code> に <code>env</code> で指定した環境が存在すれば、全てのパラメータを <code>parameter.ts</code> の値で上書きします。<code>env</code> で指定した環境が <code>parameter.ts</code> に存在しない場合は、<code>cdk.json</code> の <code>context</code> のパラメータでアプリケーションがデプロイされます。</p>
<p>以下の値を設定します。</p>
<ul>
<li><code>env</code> ... 環境名 (デフォルト: "" (空文字))</li>
</ul>
<p><strong><a href="https://github.com/aws-samples/generative-ai-use-cases/blob/main/packages/cdk/cdk.json">packages/cdk/cdk.json</a> を編集</strong></p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;env&quot;: &quot;&lt;環境名&gt;&quot;
  }
}
</code></pre>
<p>もしくは <strong>コマンドで context を指定</strong> してデプロイすることも可能です。</p>
<pre><code>npm run cdk:deploy -- -c env=&lt;環境名&gt;
</code></pre>
<p>設定例</p>
<pre><code class="language-json">// cdk.json
{
  &quot;context&quot;: {
    &quot;env&quot;: &quot;dev&quot;
  }
}
</code></pre>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  ページトップへ戻る
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="フッター" >
        
          
          <a href="DEPLOY_ON_CLOUDSHELL.html" class="md-footer__link md-footer__link--prev" aria-label="前: (オプション) AWS CloudShell でデプロイする">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                前
              </span>
              <div class="md-ellipsis">
                (オプション) AWS CloudShell でデプロイする
              </div>
            </div>
          </a>
        
        
          
          <a href="SAML_WITH_GOOGLE_WORKSPACE.html" class="md-footer__link md-footer__link--next" aria-label="次: Google Workspace で認証する">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                次
              </span>
              <div class="md-ellipsis">
                Google Workspace で認証する
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2025, Amazon Web Services, Inc. or its affiliates. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.trackings", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>